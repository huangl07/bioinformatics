cscope 15 /share/nas9/macx/research/slaf4/MSTmap/v1.1/src -q 0000000522 0000108767
	@MSTOpt.cpp

10 
	~"MSTO±.h
"

11 
	~<io¡»am
>

12 
	~<queue
>

13 
	~<ÿs£¹
>

14 
	~"cÚ¡ªts.h
"

16 
	gMSTO±
::
MSTO±
(cÚ¡ 
veùÜ
<veùÜ<> > & 
_·œ_wi£_di¡ªûs
, 
_num_bšs
, 
Ã¡ed_Ëv–
)

17 : 
·œ_wi£_di¡ªûs
(
_·œ_wi£_di¡ªûs
), 
	$numb”_of_bšs
(
_num_bšs
) {

18 
v”bo£_
 = 
kMSTV”bo£
;

19 
	`as£¹
(
·œ_wi£_di¡ªûs
.
	`size
(è=ğ
numb”_of_bšs
);

20 
Ã¡ed_Ëv–_
 = 
Ã¡ed_Ëv–
;

21 
	`fšd_İt_Üd”
();

22 
	}
};

25 
	gMSTO±
::
	$ÿlcuÏ‹_MST
()

27 
MST
.
	`»size
(
numb”_of_bšs
);

28 
veùÜ
<> 
	`e¡im©ed_di¡ªû
(
numb”_of_bšs
, 
num”ic_lim™s
<>::
	`max
());

29 
veùÜ
<
boŞ
> 
	`vis™‹d
(
numb”_of_bšs
, 
çl£
);

30 
e¡im©ed_di¡ªû
[0] = 0;

31 
MST
[0] = 0;

32 
MST_low”_bound
 = 0 ;

34 
ii
 = 0 ; i˜< 
numb”_of_bšs
 ; ii++)

37 
şo£¡_v”‹x
 = -1;

38 
shÜ‹¡_di¡ªû
 = 
num”ic_lim™s
<>::
	`max
();

54 
jj
 = 0; jj < 
numb”_of_bšs
; jj ++)

56 ià((
vis™‹d
[
jj
] =ğ
çl£
è
	`ªd
 (
shÜ‹¡_di¡ªû
 > 
e¡im©ed_di¡ªû
[jj]))

58 
şo£¡_v”‹x
 = 
jj
;

59 
shÜ‹¡_di¡ªû
 = 
e¡im©ed_di¡ªû
[
jj
];

63 
	`as£¹
(
şo£¡_v”‹x
 != -1);

65 
vis™‹d
[
şo£¡_v”‹x
] = 
Œue
;

66 
MST_low”_bound
 = MST_low”_bound + 
shÜ‹¡_di¡ªû
;

69 
jj
 = 0 ; jj < 
numb”_of_bšs
; jj++)

71 ià((
vis™‹d
[
jj
] =ğ
çl£
è
	`ªd
 (
e¡im©ed_di¡ªû
[jj] > 
·œ_wi£_di¡ªûs
[
şo£¡_v”‹x
][jj]))

73 
e¡im©ed_di¡ªû
[
jj
] = 
·œ_wi£_di¡ªûs
[
şo£¡_v”‹x
][jj];

74 
MST
[
jj
] = 
şo£¡_v”‹x
;

79  
MST_low”_bound
;

80 
	}
};

83 
	gMSTO±
::
	$fšd_İt_Üd”
()

85 
	`ÿlcuÏ‹_MST
();

86 ià(
v”bo£_
) {

87 
cout
 << "fšished c®cuÏtšg MST" << 
’dl
;

89 
	`Ãw_£rŸliz©iÚ
();

90 
	`loÿl_im´ovem’t
();

94 ià(
Ã¡ed_Ëv–_
 <= 2) {

95 
boŞ
 
chªged
 = 
Œue
;

96 
chªged
) {

97 
chªged
 = 
	`block_İtimize
();

100 
	}
};

103 
	gMSTO±
::
	$loÿl_im´ovem’t
()

106 ià(
cu¼’t_uµ”_bound
 > 
MST_low”_bound
)

108 
boŞ
 
chªged
 = 
Œue
;

111 
veùÜ
<> 
	`tmp_¡Üage
(
numb”_of_bšs
, -1);

113 
chªged
)

116 
chªged
)

118 
chªged
 = 
çl£
;

123 
ii
 = 1; i˜< 
numb”_of_bšs
; ii ++)

125 
jj
 = 
ii
+1; jj < 
numb”_of_bšs
; jj++)

129 
gÚe_edges_weight
 = 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
-1]][current_order[ii]] +

130 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
jj
-1]][current_order[jj]];

137 
block_Üd”_ty³
 = 0 ;

139 
ligh‹¡_edges_weight
 = 
gÚe_edges_weight
;

141 
boŞ
 
æ_1
 = 
çl£
;

142 
boŞ
 
æ_2
 = 
çl£
;

143 
boŞ
 
æ_3
 = 
çl£
;

146 
ff1
 = 0 ; ff1 < 2 ; ff1 ++)

148 
ff2
 = 0 ; ff2 < 2; ff2++)

150 
ff3
 = 0 ; ff3 < 2 ; ff3++)

153 
’d1
 = 
cu¼’t_Üd”
[
ii
-1];

154 
’d2
 = 
cu¼’t_Üd”
[
ii
];

155 
’d3
 = 
cu¼’t_Üd”
[
jj
-1];

156 
’d4
 = 
cu¼’t_Üd”
[
jj
];

157 ià(
ff1
 =ğ1è
’d1
 = 
cu¼’t_Üd”
[0];

158 ià(
ff2
 =ğ1è{ 
’d2
 = 
cu¼’t_Üd”
[
jj
-1]; 
’d3
 = cu¼’t_Üd”[
ii
];}

159 ià(
ff3
 =ğ1è
’d4
 = 
cu¼’t_Üd”
[
numb”_of_bšs
-1];

161 
cu¼’t_edges_weight
 = 
·œ_wi£_di¡ªûs
[
’d1
][
’d2
] +…aœ_wi£_di¡ªûs[
’d3
][
’d4
];

163 ià(
ligh‹¡_edges_weight
 > 
cu¼’t_edges_weight
)

165 
ligh‹¡_edges_weight
 = 
cu¼’t_edges_weight
;

166 
block_Üd”_ty³
 = 1;

167 ià(
ff1
 =ğ0è
æ_1
 = 
çl£
; æ_1 = 
Œue
;

168 ià(
ff2
 =ğ0è
æ_2
 = 
çl£
; æ_2 = 
Œue
;

169 ià(
ff3
 =ğ0è
æ_3
 = 
çl£
; æ_3 = 
Œue
;

176 
ff1
 = 0 ; ff1 < 2 ; ff1 ++)

178 
ff2
 = 0 ; ff2 < 2; ff2++)

180 
ff3
 = 0 ; ff3 < 2 ; ff3++)

183 
’d1
 = 
cu¼’t_Üd”
[
jj
-1];

184 
’d2
 = 
cu¼’t_Üd”
[0];

185 
’d3
 = 
cu¼’t_Üd”
[
ii
-1];

186 
’d4
 = 
cu¼’t_Üd”
[
jj
];

187 ià(
ff2
 =ğ1è
’d1
 = 
cu¼’t_Üd”
[
ii
];

188 ià(
ff1
 =ğ1è{ 
’d2
 = 
cu¼’t_Üd”
[
ii
-1]; 
’d3
 = current_order[0];}

189 ià(
ff3
 =ğ1è
’d4
 = 
cu¼’t_Üd”
[
numb”_of_bšs
-1];

191 
cu¼’t_edges_weight
 = 
·œ_wi£_di¡ªûs
[
’d1
][
’d2
] +…aœ_wi£_di¡ªûs[
’d3
][
’d4
];

193 ià(
ligh‹¡_edges_weight
 > 
cu¼’t_edges_weight
)

195 
ligh‹¡_edges_weight
 = 
cu¼’t_edges_weight
;

196 
block_Üd”_ty³
 = 2;

197 ià(
ff1
 =ğ0è
æ_1
 = 
çl£
; æ_1 = 
Œue
;

198 ià(
ff2
 =ğ0è
æ_2
 = 
çl£
; æ_2 = 
Œue
;

199 ià(
ff3
 =ğ0è
æ_3
 = 
çl£
; æ_3 = 
Œue
;

206 
ff1
 = 0 ; ff1 < 2 ; ff1 ++)

208 
ff2
 = 0 ; ff2 < 2; ff2++)

210 
ff3
 = 0 ; ff3 < 2 ; ff3++)

213 
’d1
 = 
cu¼’t_Üd”
[
ii
-1];

214 
’d2
 = 
cu¼’t_Üd”
[
jj
];

215 
’d3
 = 
cu¼’t_Üd”
[
numb”_of_bšs
-1];

216 
’d4
 = 
cu¼’t_Üd”
[
ii
];

217 ià(
ff1
 =ğ1è
’d1
 = 
cu¼’t_Üd”
[0];

218 ià(
ff3
 =ğ1è{ 
’d2
 = 
cu¼’t_Üd”
[
numb”_of_bšs
-1]; 
’d3
 = cu¼’t_Üd”[
jj
];}

219 ià(
ff2
 =ğ1è
’d4
 = 
cu¼’t_Üd”
[
jj
-1];

221 
cu¼’t_edges_weight
 = 
·œ_wi£_di¡ªûs
[
’d1
][
’d2
] +…aœ_wi£_di¡ªûs[
’d3
][
’d4
];

223 ià(
ligh‹¡_edges_weight
 > 
cu¼’t_edges_weight
)

225 
ligh‹¡_edges_weight
 = 
cu¼’t_edges_weight
;

226 
block_Üd”_ty³
 = 3;

227 ià(
ff1
 =ğ0è
æ_1
 = 
çl£
; æ_1 = 
Œue
;

228 ià(
ff2
 =ğ0è
æ_2
 = 
çl£
; æ_2 = 
Œue
;

229 ià(
ff3
 =ğ0è
æ_3
 = 
çl£
; æ_3 = 
Œue
;

235 ià(
block_Üd”_ty³
 == 1)

237 ià(
æ_1
)

239 
	`cİy_Üd”
(
cu¼’t_Üd”
, 
tmp_¡Üage
,0,0,
ii
, 
çl£
);

240 
	`cİy_Üd”
(
tmp_¡Üage
,
cu¼’t_Üd”
,0,0,
ii
, 
Œue
);

242 ià(
æ_2
)

244 
	`cİy_Üd”
(
cu¼’t_Üd”
,
tmp_¡Üage
,
ii
,ii,
jj
-ii, 
çl£
);

245 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
,
ii
,ii,
jj
-ii, 
Œue
);

247 ià(
æ_3
)

249 
	`cİy_Üd”
(
cu¼’t_Üd”
, 
tmp_¡Üage
,
jj
, jj, 
numb”_of_bšs
 - jj, 
çl£
);

250 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
, 
jj
, jj, 
numb”_of_bšs
 - jj, 
Œue
);

253 ià(
block_Üd”_ty³
 == 2)

255 
	`cİy_Üd”
(
cu¼’t_Üd”
,
tmp_¡Üage
, 0 , 0, 
jj
, 
çl£
);

257 ià(
æ_1
)

259 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
,0,
jj
-
ii
,ii,
Œue
);

263 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
,0,
jj
-
ii
,ii,
çl£
);

266 ià(
æ_2
)

268 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
,
ii
,0,
jj
-ii,
Œue
);

272 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
,
ii
,0,
jj
-ii,
çl£
);

275 ià(
æ_3
)

277 
	`cİy_Üd”
(
cu¼’t_Üd”
, 
tmp_¡Üage
,
jj
, jj, 
numb”_of_bšs
 - jj, 
çl£
);

278 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
, 
jj
, jj, 
numb”_of_bšs
 - jj, 
Œue
);

281 ià(
block_Üd”_ty³
 == 3)

284 ià(
æ_1
)

286 
	`cİy_Üd”
(
cu¼’t_Üd”
, 
tmp_¡Üage
,0,0,
ii
,
çl£
);

287 
	`cİy_Üd”
(
tmp_¡Üage
,
cu¼’t_Üd”
,0,0,
ii
,
Œue
);

290 
	`cİy_Üd”
(
cu¼’t_Üd”
,
tmp_¡Üage
,
ii
,ii,
numb”_of_bšs
-ii,
çl£
);

292 ià(
æ_2
)

294 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
, 
ii
, 
numb”_of_bšs
 - (
jj
-ii), jj - i˜, 
Œue
);

298 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
, 
ii
, 
numb”_of_bšs
 - (
jj
-ii), jj - i˜, 
çl£
);

301 ià(
æ_3
)

303 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
, 
jj
, 
ii
, 
numb”_of_bšs
 - jj, 
Œue
);

307 
	`cİy_Üd”
(
tmp_¡Üage
, 
cu¼’t_Üd”
, 
jj
, 
ii
, 
numb”_of_bšs
 - jj, 
çl£
);

311 ià(
block_Üd”_ty³
 != 0)

313 
chªged
 = 
Œue
;

314 
cu¼’t_uµ”_bound
 = cu¼’t_uµ”_bound + 
ligh‹¡_edges_weight
 - 
gÚe_edges_weight
;

319 if(
v”bo£_
) {

320 
cout
 << "cu¼’ˆuµ”_bound op2:" << 
cu¼’t_uµ”_bound
 << 
’dl
;

325 
chªged
 = 
	`dis_loÿ‹
();

326 if(
v”bo£_
) {

327 
cout
 << "cu¼’ˆuµ”_bound di¦oÿtiÚ:" << 
cu¼’t_uµ”_bound
 << 
’dl
;

331 
	}
};

334 
	gMSTO±
::
	$ÿlcuÏ‹_üt_uµ”_bound
(){

335 
tÙ®_co¡
 = 0.0;

336 
ii
 = 1; i˜< 
numb”_of_bšs
; ii++) {

337 
tÙ®_co¡
 =Ù®_co¡ + 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
]][current_order[ii - 1]];

339  
tÙ®_co¡
;

340 
	}
};

343 
	gMSTO±
::
cİy_Üd”
(
veùÜ
<> & 
Üd”_äom
,

344 
veùÜ
<> & 
Üd”_to
,

345 
äom_¡¬t_©
,

346 
to_¡¬t_©
,

347 
Ëngth
,

348 
boŞ
 
chªge_Ü›Á©iÚ
) {

349 iàĞ
nÙ
 
	gchªge_Ü›Á©iÚ
 )

351 
	gii
 = 0 ; i˜< 
	gËngth
; ii++)

353 
	gÜd”_to
[
to_¡¬t_©
 + 
ii
] = 
Üd”_äom
[
äom_¡¬t_©
 + ii];

358 
	gii
 = 0 ; i˜< 
	gËngth
; ii++)

360 
	gÜd”_to
[
to_¡¬t_©
 + 
ii
] = 
Üd”_äom
[
äom_¡¬t_©
 + 
Ëngth
 - ii - 1];

367 
boŞ
 
	gMSTO±
::
	$dis_loÿ‹
()

371 
·œ
<,> 
üt_Üd”
[
numb”_of_bšs
];

373 
ii
 = 0 ; i˜< 
numb”_of_bšs
 -1 ; ii++)

375 
üt_Üd”
[
cu¼’t_Üd”
[
ii
]].
£cÚd
 = current_order[ii+1];

377 
üt_Üd”
[
cu¼’t_Üd”
[
numb”_of_bšs
 -1 ]].
£cÚd
 = -1;

378 
ii
 = 1 ; i˜< 
numb”_of_bšs
 ; ii++)

380 
üt_Üd”
[
cu¼’t_Üd”
[
ii
]].
fœ¡
 = current_order[ii-1];

382 
üt_Üd”
[
cu¼’t_Üd”
[0]].
fœ¡
 = -1;

383 
h—d”
 = 
cu¼’t_Üd”
[0];

386 
boŞ
 
ev”_chªged
 = 
çl£
;

387 
boŞ
 
chªged
 = 
Œue
;

388 
chªged
)

390 
chªged
 = 
çl£
;

392 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii ++)

394 
šüe_co¡_¥licšg
 = 0;

395 
´evious
 = 
üt_Üd”
[
ii
].
fœ¡
;

396 
Ãxt
 = 
üt_Üd”
[
ii
].
£cÚd
;

397 ià(
´evious
 != -1) {

398 
šüe_co¡_¥licšg
 = inüe_co¡_¥licšg - 
·œ_wi£_di¡ªûs
[
ii
][
´evious
];

400 ià(
Ãxt
 != -1 ) {

401 
šüe_co¡_¥licšg
 = inüe_co¡_¥licšg - 
·œ_wi£_di¡ªûs
[
ii
][
Ãxt
];

403 ià((
´evious
 !ğ-1è
	`ªd
 (
Ãxt
 != -1)) {

404 
šüe_co¡_¥licšg
 = inüe_co¡_¥licšg + 
·œ_wi£_di¡ªûs
[
´evious
][
Ãxt
];

407 
İt_pos
 = -1;

408 
šüe_co¡_š£¹iÚ
 = 0;

409 ià(
h—d”
 !ğ
ii
) {

410 
šüe_co¡_š£¹iÚ
 = inüe_co¡_š£¹iÚ + 
·œ_wi£_di¡ªûs
[
ii
][
h—d”
];

413 
šüe_co¡_š£¹iÚ
 = inüe_co¡_š£¹iÚ + 
·œ_wi£_di¡ªûs
[
ii
][
Ãxt
];

415 
jj
 = 0 ; jj < 
numb”_of_bšs
; jj ++)

417 ià((
jj
 !ğ
ii
è
	`ªd
 (jj !ğ
´evious
))

419 
tmp_co¡
 = 0 ;

420 
jj_Ãxt
 = 
üt_Üd”
[
jj
].
£cÚd
;

421 
tmp_co¡
 =mp_co¡ + 
·œ_wi£_di¡ªûs
[
jj
][
ii
];

422 ià(
jj_Ãxt
 != -1)

424 
tmp_co¡
 =mp_co¡ + 
·œ_wi£_di¡ªûs
[
ii
][
jj_Ãxt
];

425 
tmp_co¡
 =mp_co¡ - 
·œ_wi£_di¡ªûs
[
jj
][
jj_Ãxt
];

427 ià(
tmp_co¡
 < 
šüe_co¡_š£¹iÚ
)

429 
šüe_co¡_š£¹iÚ
 = 
tmp_co¡
;

430 
İt_pos
 = 
jj
;

435 ià((
šüe_co¡_š£¹iÚ
 + 
šüe_co¡_¥licšg
è< 
ZERO_MINUS
 )

439 
ev”_chªged
 = 
Œue
;

440 
chªged
 = 
Œue
;

441 ià(
´evious
 != -1)

443 
üt_Üd”
[
´evious
].
£cÚd
 = c¹_Üd”[
ii
].second;

445 ià(
Ãxt
 != -1)

447 
üt_Üd”
[
Ãxt
].
fœ¡
 = c¹_Üd”[
ii
].first;

449 ià(
´evious
 == -1)

451 
h—d”
 = 
Ãxt
;

454 ià(
İt_pos
 == -1)

456 
üt_Üd”
[
ii
].
£cÚd
 = 
h—d”
;

457 
üt_Üd”
[
ii
].
fœ¡
 = -1;

458 
üt_Üd”
[
h—d”
].
fœ¡
 = 
ii
;

459 
h—d”
 = 
ii
;

463 
jj_Ãxt
 = 
üt_Üd”
[
İt_pos
].
£cÚd
;

464 
üt_Üd”
[
İt_pos
].
£cÚd
 = 
ii
;

465 
üt_Üd”
[
ii
].
fœ¡
 = 
İt_pos
;

466 
üt_Üd”
[
ii
].
£cÚd
 = 
jj_Ãxt
;

467 ià(
jj_Ãxt
 != -1)

469 
üt_Üd”
[
jj_Ãxt
].
fœ¡
 = 
ii
;

472 
cu¼’t_uµ”_bound
 = cu¼’t_uµ”_bound + 
šüe_co¡_š£¹iÚ
 + 
šüe_co¡_¥licšg
;

479 
cu¼’t_Üd”
[0] = 
h—d”
;

480 
nxt_id
 = 
üt_Üd”
[
h—d”
].
£cÚd
;

481 
ii
 = 1 ; i˜< 
numb”_of_bšs
 ; ii++)

483 
cu¼’t_Üd”
[
ii
] = 
nxt_id
;

484 
nxt_id
 = 
üt_Üd”
[nxt_id].
£cÚd
;

487 
üt_co¡
 = 
	`ÿlcuÏ‹_üt_uµ”_bound
();

488 
	`as£¹
(
üt_co¡
 < 
cu¼’t_uµ”_bound
 + 
ZERO_PLUS
);

489 
	`as£¹
(
üt_co¡
 > 
cu¼’t_uµ”_bound
 - 
ZERO_PLUS
);

491  
ev”_chªged
;

493 
	}
}

496 
	gveùÜ
<> 
	gMSTO±
::
	$g‘_the_lÚge¡_·th
()

498 
veùÜ
<veùÜ<> > 
	`g¿ph_MST
(
numb”_of_bšs
);

499 
ii
 = 1 ; i˜< 
numb”_of_bšs
; ii++)

501 
jj
 = 
MST
[
ii
];

502 
g¿ph_MST
[
ii
].
	`push_back
(
jj
);

503 
g¿ph_MST
[
jj
].
	`push_back
(
ii
);

505 
veùÜ
<> 
lÚge¡_·th
;

507 
lÚge¡_di¡ªû
 = -1;

510 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii ++)

512 
veùÜ
<
boŞ
> 
	`vis™‹d
(
numb”_of_bšs
, 
çl£
);

513 
veùÜ
<> 
	`d•th
(
numb”_of_bšs
, 0);

514 
vis™‹d
[
ii
] = 
Œue
;

515 
veùÜ
<> 
	`BFS_Œ“
(
numb”_of_bšs
);

516 
BFS_Œ“
[
ii
] = -1;

517 
queue
<> 
fifoqueue
;

518 
Ï¡_out
 = -1;

519 
fifoqueue
.
	`push
(
ii
);

520  
nÙ
 
fifoqueue
.
	`em±y
())

522 
Ï¡_out
 = 
fifoqueue
.
	`äÚt
();

523 
fifoqueue
.
	`pİ
();

524 
veùÜ
<>::
™”©Ü
 
™”1
 = (
g¿ph_MST
[
Ï¡_out
]).
	`begš
();

525 
™”1
 !ğ(
g¿ph_MST
[
Ï¡_out
]).
	`’d
();

526 
™”1
 ++ )

528 ià(
nÙ
 
vis™‹d
[*
™”1
])

530 
fifoqueue
.
	`push
(*
™”1
);

531 
vis™‹d
[*
™”1
] = 
Œue
;

532 
d•th
[*
™”1
] = d•th[
Ï¡_out
] + 1;

533 
BFS_Œ“
[*
™”1
] = 
Ï¡_out
;

537 ià(
d•th
[
Ï¡_out
] > 
lÚge¡_di¡ªû
)

539 
lÚge¡_di¡ªû
 = 
d•th
[
Ï¡_out
];

540 
lÚge¡_·th
.
	`ş—r
();

541 
lÚge¡_·th
.
	`push_back
(
Ï¡_out
);

542 
Ï¡_out
 = 
BFS_Œ“
[last_out];

543 
Ï¡_out
 != -1)

545 
lÚge¡_·th
.
	`push_back
(
Ï¡_out
);

546 
Ï¡_out
 = 
BFS_Œ“
[last_out];

550  
lÚge¡_·th
;

551 
	}
};

554 
	gMSTO±
::
	$Ãw_£rŸliz©iÚ
()

556 
veùÜ
<> 
lÚge¡_·th
 = 
	`g‘_the_lÚge¡_·th
();

558 
veùÜ
<
·œ
<,> > 
	`üt_·th
(
numb”_of_bšs
,
	`make_·œ
(-1,-1));

559 if(
v”bo£_
){

560 
cout
 << "thËngth oàthlÚge¡…©h:" << 
lÚge¡_·th
.
	`size
(è<< 
’dl
;

562 
h—d”
;

563 
h—d”
 = 
lÚge¡_·th
[0];

564 
üt_·th
[
h—d”
].
fœ¡
=-1;

565 
üt_·th
[
h—d”
].
£cÚd
 = -1;

566 
üt_node
 = 
h—d”
;

567  
ii
 = 1; i˜< 
lÚge¡_·th
.
	`size
(); ii++)

569 
jj
 = 
lÚge¡_·th
[
ii
];

570 
üt_·th
[
jj
].
fœ¡
 = 
üt_node
;

571 
üt_·th
[
jj
].
£cÚd
 = -1;

572 
üt_·th
[
üt_node
].
£cÚd
 = 
jj
;

573 
üt_node
 = 
jj
;

578 
veùÜ
<
boŞ
> 
	`vis™‹d
(
numb”_of_bšs
, 
çl£
);

579 
ii
 = 0 ; i˜< 
lÚge¡_·th
.
	`size
(); ii ++)

581 
vis™‹d
[
lÚge¡_·th
[
ii
]] = 
Œue
;

586 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

588 ià(
vis™‹d
[
ii
] =ğ
çl£
)

590 
vis™‹d
[
ii
] = 
Œue
;

591 
İt_co¡
 = 
·œ_wi£_di¡ªûs
[
ii
][
h—d”
] ;

592 
İt_posi
 = -1;

593 
üt_posi
 = 
h—d”
;

594 
üt_posi
 != -1)

596 
tmp_co¡
;

597 
tmp_co¡
 = 
·œ_wi£_di¡ªûs
[
üt_posi
][
ii
];

598 
kk
 = 
üt_·th
[
üt_posi
].
£cÚd
;

599 ià(
kk
 != -1)

601 
tmp_co¡
 =mp_co¡ + 
·œ_wi£_di¡ªûs
[
ii
][
kk
];

602 
tmp_co¡
 =mp_co¡ - 
·œ_wi£_di¡ªûs
[
üt_posi
][
kk
];

604 ià(
tmp_co¡
 < 
İt_co¡
)

606 
İt_co¡
 = 
tmp_co¡
;

607 
İt_posi
 = 
üt_posi
;

609 
üt_posi
 = (
üt_·th
[üt_posi]).
£cÚd
;

611 ià(
İt_posi
 == -1)

613 
üt_·th
[
ii
].
£cÚd
 = 
h—d”
;

614 
üt_·th
[
ii
].
fœ¡
 = -1;

615 
üt_·th
[
h—d”
].
fœ¡
 = 
ii
;

616 
h—d”
 = 
ii
;

620 
kk
 = (
üt_·th
[
İt_posi
]).
£cÚd
;

621 
üt_·th
[
ii
].
£cÚd
 = 
kk
;

622 
üt_·th
[
ii
].
fœ¡
 = 
İt_posi
;

623 
üt_·th
[
İt_posi
].
£cÚd
 = 
ii
;

624 ià(
kk
 != -1)

626 
üt_·th
[
kk
].
fœ¡
 = 
ii
;

634 
cu¼’t_Üd”
.
	`»size
(
numb”_of_bšs
);

635 
cu¼’t_Üd”
[0] = 
h—d”
;

636 
üt_node_id
 = 
üt_·th
[
h—d”
].
£cÚd
;

637 
ii
 = 1; i˜< 
numb”_of_bšs
; ii ++)

639 
cu¼’t_Üd”
[
ii
] = 
üt_node_id
;

640 
üt_node_id
 = (
üt_·th
[üt_node_id]).
£cÚd
;

643 
cu¼’t_uµ”_bound
 = 0 ;

644 
ii
 = 1 ; i˜< 
numb”_of_bšs
; ii ++)

646 
cu¼’t_uµ”_bound
 = cu¼’t_uµ”_bound + 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
]][current_order[ii-1]];

650 
co¡_aá”_š™Ÿliz©iÚ
 = 
cu¼’t_uµ”_bound
;

652  
cu¼’t_uµ”_bound
;

654 
	}
};

657 
	gMSTO±
::
Block_Chaš
 
MSTO±
::
	$b»ak_što_blocks
(){

658 
bs
 = 0;

659 
Block_Chaš
 
bc
;

660 
ii
 = 1; i˜< 
numb”_of_bšs
; ii++) {

662 
veùÜ
<> 
nodes_befÜe
;

663 
veùÜ
<> 
nodes_aá”
;

664 
fœ¡_node
 = 
cu¼’t_Üd”
[
ii
 - 1];

665 
£cÚd_node
 = 
cu¼’t_Üd”
[
ii
];

666 
co¡_of_edge
 = 
·œ_wi£_di¡ªûs
[
fœ¡_node
][
£cÚd_node
];

667 
jj
 = 0; jj < 
ii
 - 1; jj++) {

668 
nodes_befÜe
.
	`push_back
(
cu¼’t_Üd”
[
jj
]);

670 
jj
 = 
ii
 + 1; jj < 
numb”_of_bšs
; jj++) {

671 
nodes_aá”
.
	`push_back
(
cu¼’t_Üd”
[
jj
]);

673 
boŞ
 
v®id
 = 
Œue
;

674 
veùÜ
<>::
™”©Ü
 
™”1
 = 
nodes_befÜe
.
	`begš
(); i‹r1 !ğnodes_befÜe.
	`’d
(); ++iter1) {

675 ià(
·œ_wi£_di¡ªûs
[*
™”1
][
£cÚd_node
] < 
co¡_of_edge
) {

676 
v®id
 = 
çl£
;

680 
veùÜ
<>::
™”©Ü
 
™”1
 = 
nodes_aá”
.
	`begš
(); i‹r1 !ğnodes_aá”.
	`’d
(); ++iter1) {

681 ià(
·œ_wi£_di¡ªûs
[
fœ¡_node
][*
™”1
] < 
co¡_of_edge
) {

682 
v®id
 = 
çl£
;

686 ià(
nÙ
 
v®id
) {

687 
veùÜ
<> 
block_m¬k”s
;

688 
jj
 = 
bs
; jj < 
ii
; jj++) {

689 
block_m¬k”s
.
	`push_back
(
cu¼’t_Üd”
[
jj
]);

691 
Block
 
üt_block
 = {
Œue
, 
block_m¬k”s
, block_m¬k”s.
	`size
(),

692 
block_m¬k”s
[0], block_m¬k”s[block_m¬k”s.
	`size
() - 1],

694 
bc
.
bs
.
	`push_back
(
üt_block
);

695 
bs
 = 
ii
;

700 
veùÜ
<> 
Ï¡_block_m¬k”s
;

701 
jj
 = 
bs
; jj < 
numb”_of_bšs
; jj++) {

702 
Ï¡_block_m¬k”s
.
	`push_back
(
cu¼’t_Üd”
[
jj
]);

704 
Block
 
Ï¡_block
 = {
Œue
, 
Ï¡_block_m¬k”s
,

705 
Ï¡_block_m¬k”s
.
	`size
(),

706 
Ï¡_block_m¬k”s
[0],†a¡_block_m¬k”s[Ï¡_block_m¬k”s.
	`size
() - 1],

708 
bc
.
bs
.
	`push_back
(
Ï¡_block
);

711 
tÙ®_bšs
 = 0;

712 
ii
 = 0; i˜< 
bc
.
bs
.
	`size
(); ii++) {

713 
tÙ®_bšs
 =Ù®_bš + 
bc
.
bs
[
ii
].
m¬k”s
.
	`size
();

714 
bc
.
bs
[
ii
].
p_b
 = ii - 1;

715 
bc
.
bs
[
ii
].
n_b
 = ii + 1;

717 
	`as£¹
(
tÙ®_bšs
 =ğ
numb”_of_bšs
);

718 
bc
.
bs
[bc.bs.
	`size
(è- 1].
n_b
 = -1;

719 
bc
.
h—d”
 = 0;

720  
bc
;

722 
	}
};

725 
	gMSTO±
::
	$block_co¡
(cÚ¡ 
Block_Chaš
& 
bc
){

726 
tÙ®_co¡
 = 0.0;

727 
´e_block
 = 
bc
.
h—d”
;

728 
üt_block
 = 
bc
.
bs
[
´e_block
].
n_b
;

729 
üt_block
 != -1) {

730 
äom
 = -1;

731 
to
 = -1;

732 ià(
bc
.
bs
[
´e_block
].
Ü›Á©iÚ
) {

733 
äom
 = 
bc
.
bs
[
´e_block
].
Ï¡
;

735 
äom
 = 
bc
.
bs
[
´e_block
].
fœ¡
;

738 ià(
bc
.
bs
[
üt_block
].
Ü›Á©iÚ
) {

739 
to
 = 
bc
.
bs
[
üt_block
].
fœ¡
;

741 
to
 = 
bc
.
bs
[
üt_block
].
Ï¡
;

743 
tÙ®_co¡
 =Ù®_co¡ + 
·œ_wi£_di¡ªûs
[
äom
][
to
];

744 
´e_block
 = 
üt_block
;

745 
üt_block
 = 
bc
.
bs
[üt_block].
n_b
;

747  
tÙ®_co¡
;

748 
	}
};

751 
	gMSTO±
::
	$block_fix_Ü›Á©iÚ
(
Block_Chaš
& 
bc
) {

752 
boŞ
 
chªged
 = 
Œue
;

753 
š™Ÿl_co¡
 = 
	`block_co¡
(
bc
);

754 
tÙ®_co¡_»duùiÚ
 = 0.0;

755 
chªged
) {

756 
co¡_»duùiÚ_™”
 = 0.0;

757 
üt_šdex
 = 
bc
.
h—d”
;

758 
üt_šdex
 != -1){

759 
Block
& 
üt_block
 = 
bc
.
bs
[
üt_šdex
];

760 
co¡_»duùiÚ
 = 0.0;

761 ià(
üt_block
.
p_b
 != -1) {

762 cÚ¡ 
Block
& 
p_block
 = 
bc
.
bs
[
üt_block
.
p_b
];

763 
äom
 = -1;

764 ià(
p_block
.
Ü›Á©iÚ
) {

765 
äom
 = 
p_block
.
Ï¡
;

767 
äom
 = 
p_block
.
fœ¡
;

769 ià(
üt_block
.
Ü›Á©iÚ
) {

770 
co¡_»duùiÚ
 = co¡_»duùiÚ + 
·œ_wi£_di¡ªûs
[
äom
][
üt_block
.
fœ¡
] -

771 
·œ_wi£_di¡ªûs
[
äom
][
üt_block
.
Ï¡
];

773 
co¡_»duùiÚ
 = co¡_»duùiÚ + 
·œ_wi£_di¡ªûs
[
äom
][
üt_block
.
Ï¡
] -

774 
·œ_wi£_di¡ªûs
[
äom
][
üt_block
.
fœ¡
];

777 ià(
üt_block
.
n_b
 != -1) {

778 cÚ¡ 
Block
& 
n_block
 = 
bc
.
bs
[
üt_block
.
n_b
];

779 
to
 = -1;

780 ià(
n_block
.
Ü›Á©iÚ
) {

781 
to
 = 
n_block
.
fœ¡
;

783 
to
 = 
n_block
.
Ï¡
;

785 ià(
üt_block
.
Ü›Á©iÚ
) {

786 
co¡_»duùiÚ
 = co¡_»duùiÚ + 
·œ_wi£_di¡ªûs
[
to
][
üt_block
.
Ï¡
] -

787 
·œ_wi£_di¡ªûs
[
to
][
üt_block
.
fœ¡
];

789 
co¡_»duùiÚ
 = co¡_»duùiÚ + 
·œ_wi£_di¡ªûs
[
to
][
üt_block
.
fœ¡
] -

790 
·œ_wi£_di¡ªûs
[
to
][
üt_block
.
Ï¡
];

794 ià(
co¡_»duùiÚ
 > 0.0) {

795 
co¡_»duùiÚ_™”
 = co¡_»duùiÚ_™” + 
co¡_»duùiÚ
;

796 
tÙ®_co¡_»duùiÚ
 =Ù®_co¡_»duùiÚ + 
co¡_»duùiÚ
;

797 
üt_block
.
Ü›Á©iÚ
 = (
nÙ
 crt_block.orientation);

799 
üt_šdex
 = 
üt_block
.
n_b
;

801 ià(
co¡_»duùiÚ_™”
 > 
ZERO_PLUS
) {

802 
chªged
 = 
Œue
;

804 
chªged
 = 
çl£
;

807 
Ãw_co¡
 = 
	`block_co¡
(
bc
);

808 
	`as£¹
(
Ãw_co¡
 + 
tÙ®_co¡_»duùiÚ
 < 
š™Ÿl_co¡
 + 
ZERO_PLUS
);

809 
	`as£¹
(
Ãw_co¡
 + 
tÙ®_co¡_»duùiÚ
 > 
š™Ÿl_co¡
 - 
ZERO_PLUS
);

810 if(
v”bo£_
) {

811 
cout
 << "tÙ® co¡„eduùiÚ:" << 
tÙ®_co¡_»duùiÚ
 << 
’dl
;

813 
	}
};

816 
boŞ
 
	gMSTO±
::
	$block_İtimize_™”©iÚ
(
Block_Chaš
& 
bc
){

819 
tÙ®_blocks
 = 
bc
.
bs
.
	`size
();

820 if(
v”bo£_
){

821 
cout
 << "numb” oàblocks:" << 
tÙ®_blocks
 << 
’dl
;

823 ià(
tÙ®_blocks
 < 3) {

824  
çl£
;

827 
Üigš®_co¡
 = 
	`block_co¡
(
bc
);

828 
tÙ®_šüem’l_co¡
 = 0.0;

830 
veùÜ
<
Block
>& 
bs
 = 
bc
.bs;

831 
ii
 = 0; i˜< 
tÙ®_blocks
; ii++) {

832 
Block
& 
üt_block
 = 
bs
[
ii
];

833 
co¡_»duùiÚ
 = 0.0;

835 ià(
üt_block
.
n_b
 != -1) {

836 
Block
& 
Ãxt_block
 = 
bs
[
üt_block
.
n_b
];

837 
Ãxt_block
.
p_b
 = 
üt_block
.p_b;

838 
äom
 = -1;

839 
to
 = -1;

840 ià(
üt_block
.
Ü›Á©iÚ
) {

841 
äom
 = 
üt_block
.
Ï¡
;

843 
äom
 = 
üt_block
.
fœ¡
;

845 ià(
Ãxt_block
.
Ü›Á©iÚ
) {

846 
to
 = 
Ãxt_block
.
fœ¡
;

848 
to
 = 
Ãxt_block
.
Ï¡
;

850 
co¡_»duùiÚ
 = co¡_»duùiÚ + 
·œ_wi£_di¡ªûs
[
äom
][
to
];

852 ià(
üt_block
.
p_b
 != -1) {

853 
Block
& 
´evious_block
 = 
bs
[
üt_block
.
p_b
];

854 
´evious_block
.
n_b
 = 
üt_block
.n_b;

855 
äom
 = -1;

856 
to
 = -1;

857 ià(
´evious_block
.
Ü›Á©iÚ
) {

858 
äom
 = 
´evious_block
.
Ï¡
;

860 
äom
 = 
´evious_block
.
fœ¡
;

862 ià(
üt_block
.
Ü›Á©iÚ
) {

863 
to
 = 
üt_block
.
fœ¡
;

865 
to
 = 
üt_block
.
Ï¡
;

867 
co¡_»duùiÚ
 = co¡_»duùiÚ + 
·œ_wi£_di¡ªûs
[
äom
][
to
];

869 ià((
üt_block
.
n_b
 !ğ-1è
	`ªd
 (üt_block.
p_b
 != -1)) {

870 
Block
& 
´evious_block
 = 
bs
[
üt_block
.
p_b
];

871 
Block
& 
Ãxt_block
 = 
bs
[
üt_block
.
n_b
];

872 
äom
 = -1;

873 
to
 = -1;

874 ià(
´evious_block
.
Ü›Á©iÚ
) {

875 
äom
 = 
´evious_block
.
Ï¡
;

877 
äom
 = 
´evious_block
.
fœ¡
;

879 ià(
Ãxt_block
.
Ü›Á©iÚ
) {

880 
to
 = 
Ãxt_block
.
fœ¡
;

882 
to
 = 
Ãxt_block
.
Ï¡
;

884 
co¡_»duùiÚ
 = co¡_»duùiÚ - 
·œ_wi£_di¡ªûs
[
äom
][
to
];

886 ià(
ii
 =ğ
bc
.
h—d”
) {

887 
bc
.
h—d”
 = 
üt_block
.
n_b
;

889 
üt_block
.
p_b
 = -1;

890 
üt_block
.
n_b
 = -1;

897 
İt_pos
 = -1;

898 
boŞ
 
İt_Ü›Á©iÚ
 = 
Œue
;

899 
İt_co¡
 = 
num”ic_lim™s
<>::
	`max
();

901 
to
 = -1;

902 ià(
bs
[
bc
.
h—d”
].
Ü›Á©iÚ
) {

903 
to
 = 
bs
[
bc
.
h—d”
].
fœ¡
;

905 
to
 = 
bs
[
bc
.
h—d”
].
Ï¡
;

908 ià(
·œ_wi£_di¡ªûs
[
üt_block
.
fœ¡
][
to
] <…aœ_wi£_di¡ªûs[üt_block.
Ï¡
][to]) {

909 
İt_co¡
 = 
·œ_wi£_di¡ªûs
[
üt_block
.
fœ¡
][
to
];

910 
İt_Ü›Á©iÚ
 = 
çl£
;

912 
İt_co¡
 = 
·œ_wi£_di¡ªûs
[
üt_block
.
Ï¡
][
to
];

913 
İt_Ü›Á©iÚ
 = 
Œue
;

916 
jj
 = 0; jj < 
tÙ®_blocks
; jj++) {

917 ià(
jj
 =ğ
ii
) ;

919 
add™iÚ®_co¡1
 = 0.0;

920 
add™iÚ®_co¡2
 = 0.0;

921 
Block
& 
block_jj
 = 
bs
[
jj
];

922 
äom
 = -1;

923 ià(
block_jj
.
Ü›Á©iÚ
) {

924 
äom
 = 
block_jj
.
Ï¡
;

926 
äom
 = 
block_jj
.
fœ¡
;

928 
add™iÚ®_co¡1
 =‡dd™iÚ®_co¡1 + 
·œ_wi£_di¡ªûs
[
äom
][
üt_block
.
fœ¡
];

929 
add™iÚ®_co¡2
 =‡dd™iÚ®_co¡2 + 
·œ_wi£_di¡ªûs
[
äom
][
üt_block
.
Ï¡
];

930 ià(
block_jj
.
n_b
 != -1) {

931 
Block
& 
Ãxt_jj
 = 
bs
[
block_jj
.
n_b
];

932 
to
 = -1;

933 ià(
Ãxt_jj
.
Ü›Á©iÚ
) {

934 
to
 = 
Ãxt_jj
.
fœ¡
;

936 
to
 = 
Ãxt_jj
.
Ï¡
;

938 
add™iÚ®_co¡1
 =‡dd™iÚ®_co¡1 - 
·œ_wi£_di¡ªûs
[
äom
][
to
];

939 
add™iÚ®_co¡2
 =‡dd™iÚ®_co¡2 - 
·œ_wi£_di¡ªûs
[
äom
][
to
];

940 
add™iÚ®_co¡1
 =‡dd™iÚ®_co¡1 + 
·œ_wi£_di¡ªûs
[
üt_block
.
Ï¡
][
to
];

941 
add™iÚ®_co¡2
 =‡dd™iÚ®_co¡2 + 
·œ_wi£_di¡ªûs
[
üt_block
.
fœ¡
][
to
];

943 
boŞ
 
jj_Ü›Á©iÚ
 = 
Œue
;

944 
add™iÚ®_co¡
;

945 ià(
add™iÚ®_co¡1
 < 
add™iÚ®_co¡2
) {

946 
jj_Ü›Á©iÚ
 = 
Œue
;

947 
add™iÚ®_co¡
 = 
add™iÚ®_co¡1
;

949 
add™iÚ®_co¡
 = 
add™iÚ®_co¡2
;

950 
jj_Ü›Á©iÚ
 = 
çl£
;

953 ià(
add™iÚ®_co¡
 < 
İt_co¡
) {

954 
İt_co¡
 = 
add™iÚ®_co¡
;

955 
İt_pos
 = 
jj
;

956 
İt_Ü›Á©iÚ
 = 
jj_Ü›Á©iÚ
;

960 
üt_block
.
Ü›Á©iÚ
 = 
İt_Ü›Á©iÚ
;

961 ià(
İt_pos
 == -1) {

962 
üt_block
.
n_b
 = 
bc
.
h—d”
;

963 
bs
[
bc
.
h—d”
].
p_b
 = 
ii
;

964 
bc
.
h—d”
 = 
ii
;

966 
Ãxt_pos
 = 
bs
[
İt_pos
].
n_b
;

967 
üt_block
.
n_b
 = 
Ãxt_pos
;

968 
bs
[
İt_pos
].
n_b
 = 
ii
;

969 
üt_block
.
p_b
 = 
İt_pos
;

970 ià(
Ãxt_pos
 != -1) {

971 
bs
[
Ãxt_pos
].
p_b
 = 
ii
;

974 
tÙ®_šüem’l_co¡
 =Ù®_šüem’l_co¡ + 
İt_co¡
 - 
co¡_»duùiÚ
;

979 
Ãw_co¡
 = 
	`block_co¡
(
bc
);

980 
	`as£¹
(
Ãw_co¡
 < 
Üigš®_co¡
 + 
tÙ®_šüem’l_co¡
 + 
ZERO_PLUS
);

981 
	`as£¹
(
Ãw_co¡
 > 
Üigš®_co¡
 + 
tÙ®_šüem’l_co¡
 - 
ZERO_PLUS
);

982 if(
v”bo£_
){

983 
cout
 << "tÙ® inüem’Èco¡" << 
tÙ®_šüem’l_co¡
 << 
’dl
;

985 ià(
tÙ®_šüem’l_co¡
 < 
ZERO_MINUS
) {

986  
Œue
;

988  
çl£
;

990 
	}
};

993 
	gMSTO±
::
	$cİy_ov”_Üd”
(cÚ¡ 
Block_Chaš
& 
bc
){

994 
üt_block_id
 = 
bc
.
h—d”
;

995 
üt_m¬k”_id
 = 0;

996 
üt_block_id
 != -1){

997 cÚ¡ 
Block
& 
üt_block
 = 
bc
.
bs
[
üt_block_id
];

998 ià(
üt_block
.
Ü›Á©iÚ
) {

999 
ii
 = 0; i˜< 
üt_block
.
size
; ii++){

1000 
cu¼’t_Üd”
[
üt_m¬k”_id
] = 
üt_block
.
m¬k”s
[
ii
];

1001 
üt_m¬k”_id
++;

1004 
ii
 = 
üt_block
.
size
 - 1; ii >= 0; ii--) {

1005 
cu¼’t_Üd”
[
üt_m¬k”_id
] = 
üt_block
.
m¬k”s
[
ii
];

1006 
üt_m¬k”_id
++;

1009 
üt_block_id
 = 
üt_block
.
n_b
;

1011 
	`as£¹
(
üt_m¬k”_id
 =ğ
numb”_of_bšs
);

1012 
cu¼’t_uµ”_bound
 = 
	`ÿlcuÏ‹_üt_uµ”_bound
();

1013 
	}
}

1016 
	gMSTO±
::
cÚŒaù_blocks
(cÚ¡ 
Block_Chaš
& 
bc
, 
veùÜ
<veùÜ<> >& 
block_di¡ªûs
) {

1017 
	gnumb”_of_blocks
 = 
bc
.
bs
.
size
();

1018 
	gblock_di¡ªûs
.
»size
(
numb”_of_blocks
);

1019 
	gii
 = 0; i˜< 
	gnumb”_of_blocks
; ii++) {

1020 
	gblock_di¡ªûs
[
ii
].
»size
(
numb”_of_blocks
);

1023 
	gii
 = 0; i˜< 
	gnumb”_of_blocks
; ii++) {

1024 
	gjj
 = 
ii
 + 1; jj < 
	gnumb”_of_blocks
; jj++) {

1025 cÚ¡ 
	gBlock
& 
	gb_ii
 = 
bc
.
bs
[
ii
];

1026 
	gii_size
 = 
b_ii
.
size
;

1027 cÚ¡ 
	gBlock
& 
	gb_jj
 = 
bc
.
bs
[
jj
];

1028 
	gjj_size
 = 
b_jj
.
size
;

1029 
	gshÜ‹¡_di¡
 = 
num”ic_lim™s
<>::
max
();

1030 
	gkk
 = 0; kk < 
	gii_size
; kk++) {

1031 
	gÎ
 = 0;†È< 
	gjj_size
;†l++) {

1032 ià(
	g·œ_wi£_di¡ªûs
[
b_ii
.
m¬k”s
[
kk
]][
b_jj
.m¬k”s[
Î
]] < 
	gshÜ‹¡_di¡
) {

1033 
	gshÜ‹¡_di¡
 = 
·œ_wi£_di¡ªûs
[
b_ii
.
m¬k”s
[
kk
]][
b_jj
.m¬k”s[
Î
]];

1037 
	gblock_di¡ªûs
[
ii
][
jj
] = 
shÜ‹¡_di¡
;

1038 
	gblock_di¡ªûs
[
jj
][
ii
] = 
shÜ‹¡_di¡
;

1041 
	gii
 = 0; i˜< 
	gnumb”_of_blocks
; ii++) {

1042 
	gblock_di¡ªûs
[
ii
][ii] = 0;

1047 
	gMSTO±
::
	$´št_bc
(cÚ¡ 
Block_Chaš
& 
bc
){

1048 
üt_šd
 = 
bc
.
h—d”
;

1049 
üt_šd
 != -1) {

1050 cÚ¡ 
Block
& 
üt_block
 = 
bc
.
bs
[
üt_šd
];

1051 
cout
 << 
üt_block
.
size
 << '\t';

1052 
üt_šd
 = 
bc
.
bs
[üt_šd].
n_b
;

1054 
cout
 << 
’dl
;

1056 
üt_šd1
 = 
bc
.
h—d”
;

1057 
üt_šd1
 != -1) {

1058 cÚ¡ 
Block
& 
b1
 = 
bc
.
bs
[
üt_šd1
];

1059 
äom
 = -1;

1060 ià(
b1
.
Ü›Á©iÚ
) {

1061 
äom
 = 
b1
.
Ï¡
;

1063 
äom
 = 
b1
.
fœ¡
;

1065 
üt_šd2
 = 
bc
.
h—d”
;

1066 
üt_šd2
 != -1) {

1067 cÚ¡ 
Block
& 
b2
 = 
bc
.
bs
[
üt_šd2
];

1068 
to
 = -1;

1069 ià(
b2
.
Ü›Á©iÚ
) {

1070 
to
 = 
b2
.
fœ¡
;

1072 
to
 = 
b2
.
Ï¡
;

1074 ià(
üt_šd1
 !ğ
üt_šd2
) {

1075 
cout
 << 
·œ_wi£_di¡ªûs
[
äom
][
to
] << '\t';

1077 
cout
 << "0.0\t";

1080 
üt_šd2
 = 
bc
.
bs
[üt_šd2].
n_b
;

1082 
cout
 << 
’dl
;

1083 
üt_šd1
 = 
bc
.
bs
[üt_šd1].
n_b
;

1086 
	}
};

1089 
boŞ
 
	gMSTO±
::
	$block_İtimize
() {

1090 
Block_Chaš
 
bc
 = 
	`b»ak_što_blocks
();

1091 
numb”_of_blocks
 = 
bc
.
bs
.
	`size
();

1094 ià(
numb”_of_blocks
 =ğ
numb”_of_bšs
) {

1095  
çl£
;

1098 
veùÜ
<veùÜ<> > 
block_di¡ªû
;

1099 
	`cÚŒaù_blocks
(
bc
, 
block_di¡ªû
);

1118 
MSTO±
 
	`b_İt
(
block_di¡ªû
, 
numb”_of_blocks
, 
Ã¡ed_Ëv–_
 + 1);

1119 
veùÜ
<> 
b_İt_Üd”
;

1120 
veùÜ
<> 
b_m¡
;

1121 
b_low”bound
;

1122 
b_uµ”bound
;

1123 
b_š™Ÿl_co¡
;

1124 
b_İt
.
	`O±_Ord”
(
b_İt_Üd”
, 
b_m¡
, 
b_low”bound
, 
b_uµ”bound
, 
b_š™Ÿl_co¡
);

1143 
ii
 = 1; i˜< 
numb”_of_blocks
; ii++) {

1144 
bc
.
bs
[
b_İt_Üd”
[
ii
]].
p_b
 = b_opt_order[ii - 1];

1146 
ii
 = 0; i˜< 
numb”_of_blocks
 - 1; ii++) {

1147 
bc
.
bs
[
b_İt_Üd”
[
ii
]].
n_b
 = b_opt_order[ii + 1];

1149 
bc
.
bs
[
b_İt_Üd”
[0]].
p_b
 = -1;

1150 
bc
.
bs
[
b_İt_Üd”
[
numb”_of_blocks
 - 1]].
n_b
 = -1;

1151 
bc
.
h—d”
 = 
b_İt_Üd”
[0];

1153 
	`block_fix_Ü›Á©iÚ
(
bc
);

1155 
boŞ
 
chªged
 = 
Œue
;

1156 
chªged
) {

1157 
chªged
 = 
	`block_İtimize_™”©iÚ
(
bc
);

1160 
veùÜ
<> 
backup_Üd”
;

1161 
backup_Üd”
 = 
cu¼’t_Üd”
;

1162 
backup_uµ”_bound
 = 
cu¼’t_uµ”_bound
;

1163 
	`cİy_ov”_Üd”
(
bc
);

1165 
	`loÿl_im´ovem’t
();

1167 
Ãw_uµ”_bound
 = 
	`ÿlcuÏ‹_üt_uµ”_bound
();

1169 if(
v”bo£_
){

1170 
cout
 << "backup_uµ”_bound: " << 
backup_uµ”_bound
 << "Ãw_uµ”_bound: " << 
Ãw_uµ”_bound
 << 
’dl
;

1173 
boŞ
 
im´oved
 = 
çl£
;

1174 ià(
Ãw_uµ”_bound
 < 
backup_uµ”_bound
 - 
ZERO_PLUS
) {

1175 
im´oved
 = 
Œue
;

1177 
im´oved
 = 
çl£
;

1178 
cu¼’t_uµ”_bound
 = 
backup_uµ”_bound
;

1179 
cu¼’t_Üd”
 = 
backup_Üd”
;

1181  
im´oved
;

1182 
	}
};

1185 
	gMSTO±
::
O±_Ord”
(
veùÜ
<>& 
out_Üd”
,

1186 
veùÜ
<>& 
_MST
,

1187 & 
_low”bound
,

1188 & 
_uµ”_bound
,

1189 & 
_co¡_aá”_š™Ÿliz©iÚ
) {

1190 
	gout_Üd”
 = 
cu¼’t_Üd”
;

1191 
	g_MST
 = 
MST
;

1192 
	g_low”bound
 = 
MST_low”_bound
;

1193 
	g_uµ”_bound
 = 
cu¼’t_uµ”_bound
;

1194 
	g_co¡_aá”_š™Ÿliz©iÚ
 = 
co¡_aá”_š™Ÿliz©iÚ
;

1195 
§n™y_check
();

1200 
	gMSTO±
::
	$§n™y_check
(){

1204 
veùÜ
<> 
	`tmp
(
numb”_of_bšs
,0);

1205 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

1207 
tmp
[
cu¼’t_Üd”
[
ii
]] =mp[current_order[ii]] + 1;

1209 
ii
 = 0; i˜< 
numb”_of_bšs
; ii++)

1211 ià(
tmp
[
ii
] != 1 )

1213 
cout
 << "ERROR,‚Ù‡ v®id ord”. " << 
ii
 << "‡µ—»d " << 
tmp
[ii] << "time " << 
’dl
;

1214 
	`as£¹
(
çl£
);

1218 
•sÚ
 = 0.000001;

1220 
tmp_uµ”_bound
 = 0 ;

1221 
ii
 = 1 ; i˜< 
numb”_of_bšs
; ii ++)

1223 
tmp_uµ”_bound
 =mp_uµ”_bound + 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
]][current_order[ii-1]];

1226 ià(
	`nÙ
 ((
tmp_uµ”_bound
 - 
cu¼’t_uµ”_bound
 < 
•sÚ
è
	`ªd
 (tmp_upper_bound - current_upper_bound > -epsilon))){

1227 
cout
 << "ERROR, cu¼’t_uµ”_bound i nÙ cÜ»ù" << 
’dl
;

1228 
cout
 << "tmp_uµ”_bound:" << 
tmp_uµ”_bound
 << " uµ”_bound:" << 
cu¼’t_uµ”_bound
 << 
’dl
;

1229 
	`as£¹
(
çl£
);

1233 
tmp_low”_bound
 = 0 ;

1234 
ii
 = 1 ; i˜< 
numb”_of_bšs
; ii ++)

1236 
tmp_low”_bound
 =mp_low”_bound + 
·œ_wi£_di¡ªûs
[
MST
[
ii
]][ii];

1238 ià(
	`nÙ
 ((
tmp_low”_bound
 - 
MST_low”_bound
 < 
•sÚ
è
	`ªd
 (tmp_lower_bound - MST_lower_bound > -epsilon))) {

1239 
cout
 << "ERROR,hlow”bound i nÙ cÜ»ù" << 
’dl
;

1240 
cout
 << "tmp_low”_bound:" << 
tmp_low”_bound
 << "†ow”_bound:" << 
MST_low”_bound
 << 
’dl
;

1241 
	`as£¹
(
çl£
);

1244 
	}
};

	@MSTOpt.h

9 #iâdeà
MSTO±_HEADER


10 
	#MSTO±_HEADER


	)

12 
	~<veùÜ
>

13 
	~<lim™s
>

15 
usšg
 
Çme¥aû
 
	g¡d
;

17 şas 
	cMSTO±
{

18 
	mpublic
:

19 
MSTO±
(cÚ¡ 
veùÜ
<veùÜ<> >& 
_·œ_wi£_di¡ªûs
, 
num_bšs
, 
Ã¡ed_Ëv–
);

20 
O±_Ord”
(
veùÜ
<>& 
İt_Üd”
,

21 
veùÜ
<>& 
_MST
,

22 & 
_low”bound
,

23 & 
_uµ”_bound
,

24 & 
_co¡_aá”_š™Ÿliz©iÚ
);

25 
	m´iv©e
:

29 
	sBlock
{

30 
boŞ
 
Ü›Á©iÚ
;

31 
	mveùÜ
<> 
	mm¬k”s
;

32 
	msize
;

33 
	mfœ¡
;

34 
	mÏ¡
;

37 
	mp_b
;

40 
	mn_b
;

43 
	sBlock_Chaš
{

44 
	gveùÜ
<
	gBlock
> 
	gbs
;

45 
	gh—d”
;

52 
§n™y_check
();

54 
fšd_İt_Üd”
();

58 
ÿlcuÏ‹_MST
();

60 
Ãw_£rŸliz©iÚ
();

63 
loÿl_im´ovem’t
();

65 
	gveùÜ
<> 
g‘_the_lÚge¡_·th
();

67 
ÿlcuÏ‹_üt_uµ”_bound
();

69 
cİy_Üd”
(
veùÜ
<> & 
Üd”_äom
,

70 
veùÜ
<> & 
Üd”_to
,

71 
äom_¡¬t_©
,

72 
to_¡¬t_©
,

73 
Ëngth
,

74 
boŞ
 
chªge_Ü›Á©iÚ
);

76 
boŞ
 
dis_loÿ‹
();

79 
Block_Chaš
 
b»ak_što_blocks
();

81 
boŞ
 
block_İtimize_™”©iÚ
(
Block_Chaš
& 
bc
);

82 
block_fix_Ü›Á©iÚ
(
Block_Chaš
& 
bc
);

83 
block_co¡
(cÚ¡ 
Block_Chaš
& 
bc
);

86 
cİy_ov”_Üd”
(cÚ¡ 
Block_Chaš
& 
bc
);

87 
´št_bc
(cÚ¡ 
Block_Chaš
& 
bc
);

88 
cÚŒaù_blocks
(cÚ¡ 
Block_Chaš
& 
bc
, 
veùÜ
<veùÜ<> >& 
block_di¡ªûs
);

89 
boŞ
 
block_İtimize
();

93 
	gnumb”_of_bšs
;

94 cÚ¡ 
	gveùÜ
<veùÜ<> >& 
	g·œ_wi£_di¡ªûs
;

95 
	gveùÜ
<> 
	gcu¼’t_Üd”
;

97 
	gveùÜ
<> 
	gMST
;

98 
	gMST_low”_bound
;

99 
	gcu¼’t_uµ”_bound
;

100 
	gco¡_aá”_š™Ÿliz©iÚ
;

103 
	gÃ¡ed_Ëv–_
;

105 
boŞ
 
	gv”bo£_
;

	@constants.h

10 #iâdeà
CONSTANTS_HEADER


11 
	#CONSTANTS_HEADER


	)

13 
	~<¡ršg
>

16 
usšg
 
Çme¥aû
 
	g¡d
;

18 cÚ¡ 
	gPROB_HOEFFDING_CUT_OFF
 = 0.000001;

19 cÚ¡ 
	gZERO_MINUS
 = -0.0001;

20 cÚ¡ 
	gESTIMATION_BEFORE_CLUSTERING
 = 0.01;

21 cÚ¡ 
	gZERO_PLUS
 = 0.0001;

22 cÚ¡ 
	gMissšg_Th»shŞd
 = 0.30;

23 cÚ¡ 
	gCOMBINE_BINS_TH
 = 0.1;

24 cÚ¡ 
¡ršg
 
	gHALDANE
 = "haldane";

25 cÚ¡ 
¡ršg
 
	gKOSAMBI
 = "kosambi";

26 cÚ¡ 
	gkMaskTh»shŞd
 = 0.75;

27 cÚ¡ 
	gkMšMaskTh»shŞd
 = 0.75;

28 cÚ¡ 
	gkMaskDeüem’t
 = 0.02;

29 
	eObjFunc
{
	mOBJF_ML
, 
	mOBJF_COUNT
, 
	mOBJF_CM
};

30 cÚ¡ 
	gkMaxE¼ÜDeùiÚRounds
 = 20;

31 cÚ¡ 
	gkMaxMissšgE¡Rounds
 = 10;

32 cÚ¡ 
boŞ
 
	gkMSTV”bo£
 = 
çl£
;

33 cÚ¡ 
	gkBadD‘MaxNum
 = 8;

	@def.h

20 #iâdeà
__DEF_H__


21 
	#__DEF_H__


	)

23 
	s®Ël_¡©e
 {

24 
	mA
;

25 
	mB
;

26 
	mAB
;

27 
boŞ
 
	mmissšg
;

	@genetic_map.cpp

10 
	~"g’‘ic_m­.h
"

12 
	gg’‘ic_m­
::
	$g’‘ic_m­
() {

13 
şu¡”šg_´ob_cut_off
 = 
PROB_HOEFFDING_CUT_OFF
;

14 
numb”_of_loci
 = 0;

15 
numb”_of_šdividu®
 = 0;

16 
pİuÏtiÚ_Çme
 = "";

17 
pİuÏtiÚ_ty³
 = "";

18 
numb”_of_cÚÃùed_compÚ’ts
 = 0;

19 
tÙ®_numb”_of_missšg_obs
 = 0;

20 
objeùive_funùiÚ
 = 
OBJF_COUNT
;

21 
d‘eù_bad_d©a
 = 
çl£
;

22 
	}
}

25 
	gg’‘ic_m­
::~
	$g’‘ic_m­
() {

26 
d–‘e
 
df_
;

27 
	}
}

30 
	gg’‘ic_m­
::
	$»ad_¿w_m­pšg_d©a
(
¡ršg
 
fe_·th
) {

31 
tÙ®_numb”_of_missšg_obs
 = 0 ;

32 
if¡»am
 
	`¿w_m­pšg_d©a_fe
(
fe_·th
.
	`c_¡r
());

33 
¡ršg
 
tmp_¡r
;

35 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

36 ià(
tmp_¡r
 != "population_type")

38 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

39 
	`as£¹
(
çl£
);

42 
¿w_m­pšg_d©a_fe
 >> 
pİuÏtiÚ_ty³
;

44 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

45 ià(
tmp_¡r
 != "population_name")

47 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

48 
	`as£¹
(
çl£
);

51 
¿w_m­pšg_d©a_fe
 >> 
pİuÏtiÚ_Çme
;

53 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

54 ià(
tmp_¡r
 != "distance_function")

56 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

57 
	`as£¹
(
çl£
);

60 
¿w_m­pšg_d©a_fe
 >> 
di¡ªû_funùiÚ
;

62 ià(
di¡ªû_funùiÚ
 =ğ
HALDANE
) {

63 
df_
 = 
Ãw
 
	`DF_H®dªe
();

64 } ià(
di¡ªû_funùiÚ
 =ğ
KOSAMBI
) {

65 
df_
 = 
Ãw
 
	`DF_Ko§mbi
();

67 
cout
 << "un-»cognized di¡ªû funùiÚ‚ame" << 
’dl
;

68 
	`as£¹
(
çl£
);

71 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

72 ià(
tmp_¡r
 != "cut_off_p_value")

74 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

75 
	`as£¹
(
çl£
);

78 
¿w_m­pšg_d©a_fe
 >> 
şu¡”šg_´ob_cut_off
;

80 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

81 ià(
tmp_¡r
 != "no_map_dist")

83 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

84 
	`as£¹
(
çl£
);

87 
¿w_m­pšg_d©a_fe
 >> 
no_m­_di¡
;

89 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

90 ià(
tmp_¡r
 != "no_map_size")

92 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

93 
	`as£¹
(
çl£
);

96 
¿w_m­pšg_d©a_fe
 >> 
no_m­_size
;

98 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

99 ià(
tmp_¡r
 != "missing_threshold")

101 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

102 
	`as£¹
(
çl£
);

105 
¿w_m­pšg_d©a_fe
 >> 
missšg_th»shŞd
;

107 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

108 ià(
tmp_¡r
 != "estimation_before_clustering")

110 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

111 
	`as£¹
(
çl£
);

114 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

115 ià(
tmp_¡r
 == "yes") {

116 
e¡im©iÚ_befÜe_şu¡”šg
 = 
Œue
;

117 } ià(
tmp_¡r
 == "no") {

118 
e¡im©iÚ_befÜe_şu¡”šg
 = 
çl£
;

120 
cout
 << "uÄecognized ffÜm©" << 
’dl
;

121 
	`as£¹
(
çl£
);

124 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

125 ià(
tmp_¡r
 != "detect_bad_data")

127 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

128 
	`as£¹
(
çl£
);

131 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

132 ià(
tmp_¡r
 == "yes") {

133 
d‘eù_bad_d©a
 = 
Œue
;

134 } ià(
tmp_¡r
 == "no") {

135 
d‘eù_bad_d©a
 = 
çl£
;

137 
cout
 << "uÄecognized ffÜm©" << 
’dl
;

138 
	`as£¹
(
çl£
);

142 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

143 ià(
tmp_¡r
 != "objective_function")

145 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

146 
	`as£¹
(
çl£
);

149 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

150 ià(
tmp_¡r
 == "ML") {

151 
objeùive_funùiÚ
 = 
OBJF_ML
;

152 } ià(
tmp_¡r
 == "COUNT") {

153 
objeùive_funùiÚ
 = 
OBJF_COUNT
;

154 } ià(
tmp_¡r
 == "CM") {

155 
objeùive_funùiÚ
 = 
OBJF_CM
;

157 
cout
 << "uÄecognized ffÜm©" << 
’dl
;

158 
	`as£¹
(
çl£
);

161 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

162 ià(
tmp_¡r
 != "number_of_loci")

164 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

165 
	`as£¹
(
çl£
);

168 
¿w_m­pšg_d©a_fe
 >> 
numb”_of_loci
;

170 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

171 ià(
tmp_¡r
 != "number_of_individual")

173 
cout
 << "ERROR iÀthffÜm©" << 
’dl
;

176 
¿w_m­pšg_d©a_fe
 >> 
numb”_of_šdividu®
;

180 
šdividu®_Çmes
.
	`»size
(
numb”_of_šdividu®
);

181 
¡ršg
 
Çme_ii
;

182 
¿w_m­pšg_d©a_fe
 >> 
Çme_ii
;

183 
ii
 = 0; i˜< 
numb”_of_šdividu®
; ii++) {

184 
¿w_m­pšg_d©a_fe
 >> 
Çme_ii
;

185 
šdividu®_Çmes
[
ii
] = 
Çme_ii
;

188 
kËd_m¬k”s
 = 0;

189 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii ++)

191 
num_missšg
 = 0;

192 
veùÜ
<> 
m¬k”_d©a
;

193 
m¬k”_d©a
.
	`»size
(
numb”_of_šdividu®
);

194 
¡ršg
 
m¬k”_Çme_ii
;

195 
¿w_m­pšg_d©a_fe
 >> 
m¬k”_Çme_ii
;

196 
jj
 = 0 ; jj < 
numb”_of_šdividu®
 ; jj++)

198 
¡ršg
 
SNP_jj
;

199 
¿w_m­pšg_d©a_fe
 >> 
SNP_jj
;

200 ià((
SNP_jj
 =ğ"a"è
	`Ü
 (SNP_jj == "A") or (SNP_jj == "aa") or (SNP_jj == "AA")) {

201 
m¬k”_d©a
[
jj
] = 'A';

202 } ià((
SNP_jj
 =ğ"b"è
	`Ü
 (SNP_jj == "B") or (SNP_jj == "bb") or (SNP_jj == "BB")) {

203 
m¬k”_d©a
[
jj
] = 'B';

204 } ià((
SNP_jj
 =ğ"X"è
	`Ü
 (SNP_jj == "x") or (SNP_jj == "AB") or (SNP_jj == "ab")) {

205 
m¬k”_d©a
[
jj
] = 'X';

206 } ià((
SNP_jj
 =ğ"U"è
	`Ü
 (SNP_jj == "-") or (SNP_jj == "_") or (SNP_jj == "u") or (SNP_jj == "--") or (SNP_jj == "?")) {

207 
num_missšg
 =‚um_missing + 1;

208 
m¬k”_d©a
[
jj
] = '-';

210 
cout
 << "uÄecognzed m¬k”‡ˆlš" << 
ii
+1 << " m¬k”:" << 
m¬k”_Çme_ii
 << " cŞumÀ" << 
jj
 + 1 << 
’dl
;

211 
	`as£¹
(
çl£
);

215 ià(
num_missšg
 < 
missšg_th»shŞd
 * 
numb”_of_šdividu®
) {

216 
¿w_m­pšg_d©a
.
	`push_back
(
m¬k”_d©a
);

217 
m¬k”_Çmes
.
	`push_back
(
m¬k”_Çme_ii
);

218 
tÙ®_numb”_of_missšg_obs
 =Ù®_numb”_of_missšg_ob + 
num_missšg
;

220 
kËd_m¬k”s
 = killed_markers + 1;

221 
cout
 << "ÿutiÚ! m¬k”:" << 
m¬k”_Çme_ii
 << "wa kËd dutØtoØmªy missšg g’Ùy³ c®ls" << 
’dl
;

224 
	`as£¹
(
numb”_of_loci
 =ğ
¿w_m­pšg_d©a
.
	`size
(è+ 
kËd_m¬k”s
);

225 
	`as£¹
(
¿w_m­pšg_d©a
.
	`size
(è=ğ
m¬k”_Çmes
.size());

226 
numb”_of_loci
 = 
¿w_m­pšg_d©a
.
	`size
();

227 
¿w_m­pšg_d©a_fe
.
	`şo£
();

229 
	}
};

232 
	gg’‘ic_m­
::
	$cÚd’£_m¬k”s_što_bšs
()

234 
veùÜ
<
boŞ
> 
	`vis™‹d
(
numb”_of_loci
, 
çl£
);

235 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++) {

236 
veùÜ
<veùÜ<> > 
bšs_ii
;

237 
jj
 = 0 ; jj < (
cÚÃùed_compÚ’ts
[
ii
]).
	`size
(); jj ++) {

238 ià(
nÙ
 
vis™‹d
[
cÚÃùed_compÚ’ts
[
ii
][
jj
]]) {

239 
veùÜ
<> 
bš_ii_jj_m¬k”s
;

240 
kk
 = 
cÚÃùed_compÚ’ts
[
ii
][
jj
];

241 
bš_ii_jj_m¬k”s
.
	`push_back
(
kk
);

242 
veùÜ
<>::
™”©Ü
 
™”1
 = (
cÚÃùed_compÚ’ts
[
ii
]).
	`begš
();

243 
™”1
 !ğ(
cÚÃùed_compÚ’ts
[
ii
]).
	`’d
();

244 
™”1
++) {

245 ià((
·œ_wi£_di¡ªûs
[
kk
][*
™”1
] <ğ
ZERO_PLUS
 ) 
	`ªd
 (*™”1 !ğkkèªd (
nÙ
 
vis™‹d
[*iter1])) {

246 
bš_ii_jj_m¬k”s
.
	`push_back
(*
™”1
);

249 
veùÜ
<>::
™”©Ü
 
™”1
 = 
bš_ii_jj_m¬k”s
.
	`begš
();

250 
™”1
 !ğ
bš_ii_jj_m¬k”s
.
	`’d
();

251 
™”1
++) {

252 
vis™‹d
[*
™”1
] = 
Œue
;

254 
bšs_ii
.
	`push_back
(
bš_ii_jj_m¬k”s
);

257 
lškage_group_bšs
.
	`push_back
(
bšs_ii
);

259 
	}
}

261 
	gg’‘ic_m­
::
	$dump_di¡ªû_m©rix
() {

262 
bufãr
[10];

263 
cout
 << "m©rix dim’siÚ:" << 
·œ_wi£_di¡ªûs
.
	`size
(è<< 
’dl
;

264 
ii
 = 0; i˜< 
·œ_wi£_di¡ªûs
.
	`size
(); ii++) {

265 
jj
 = 0; jj < 
·œ_wi£_di¡ªûs
[
ii
].
	`size
(); jj++) {

266 
	`¥rštf
(
bufãr
, "%.2à", 
·œ_wi£_di¡ªûs
[
ii
][
jj
]);

267 
cout
 << 
bufãr
;

269 
cout
 << 
’dl
;

271 
	}
}

274 
	gg’‘ic_m­
::
	$dump
()

276 
cout
 << 
pİuÏtiÚ_Çme
 << 
’dl
;

277 
cout
 << 
pİuÏtiÚ_ty³
 << 
’dl
;

278 
cout
 << 
di¡ªû_funùiÚ
 << 
’dl
;

279 
cout
 << 
numb”_of_loci
 << 
’dl
;

280 
cout
 << 
numb”_of_šdividu®
 << 
’dl
;

281 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii ++) {

282 
jj
 = 0 ; jj < 
numb”_of_šdividu®
; jj ++) {

283 ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'A') {

284 
cout
 << '.';

285 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'B') {

286 
cout
 << '#';

287 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'X') {

288 
cout
 << 'X';

290 
cout
 << '-';

294 
cout
 << 
’dl
;

296 
cout
 << "thnumb” oàcÚÃùed compÚ’t " << 
numb”_of_cÚÃùed_compÚ’ts
 << 
’dl
;

297 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++)

299 
cout
 << (
cÚÃùed_compÚ’ts
[
ii
]).
	`size
() << ',';

301 
cout
 << 
’dl
;

306 
tmp_tÙ®
 = 0;

307 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++)

309 
tmp_tÙ®
 =mp_tÙ® + (
cÚÃùed_compÚ’ts
[
ii
]).
	`size
();

310 
tmp_tÙ®_ii
 = 0 ;

311 
jj
 = 0 ; jj < (
lškage_group_bšs
[
ii
]).
	`size
(); jj++) {

312 
tmp_tÙ®_ii
 =mp_tÙ®_i˜+ (
lškage_group_bšs
[
ii
][
jj
]).
	`size
();

314 ià(
tmp_tÙ®_ii
 !ğ(
cÚÃùed_compÚ’ts
[
ii
]).
	`size
()) {

315 
cout
 << "ERROR,mp_tÙ®_i˜NOTƒqu®ØcÚÃùed_compÚ’ts[ii]" << 
’dl
;

319 ià(
tmp_tÙ®
 !ğ
numb”_of_loci
)

321 
cout
 << "ERROR,mp_tÙ® NOTƒqu®Ønumb”_of_loci" << 
’dl
;

324 
	}
};

327 
	gg’‘ic_m­
::
	$dump_cÚÃùed_compÚ’ts_edges
() {

328 
cout
 << "dum°edges" << 
’dl
;

329 
th»shŞd
 = 
	`ÿlcuÏ‹_hÛffdšg_bound
(
şu¡”šg_´ob_cut_off
);

330 
cout
 << "ÿlcuÏ‹_hÛffdšg_bound:" << 
th»shŞd
 << 
’dl
;

331 
ii
 = 0; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++) {

332 
cout
 << "==============================================" << 
’dl
;

333 
cout
 << "\t";

334 
veùÜ
<> 
m¬k”s
;

335 
jj
 = 0; jj < 
lškage_group_bšs
[
ii
].
	`size
(); jj++) {

336 
m¬k”s
.
	`š£¹
(m¬k”s.
	`’d
(),

337 
lškage_group_bšs
[
ii
][
Üd”s
[ii][
jj
]].
	`begš
(),

338 
lškage_group_bšs
[
ii
][
Üd”s
[ii][
jj
]].
	`’d
());

340 
	`as£¹
(
m¬k”s
.
	`size
(è=ğ
cÚÃùed_compÚ’ts
[
ii
].size());

341 
jj
 = 0; jj < 
m¬k”s
.
	`size
(); jj++) {

342 
cout
 << 
m¬k”_Çmes
[
m¬k”s
[
jj
]] << "\t";

344 
cout
 << 
’dl
;

345 
jj
 = 0; jj < 
m¬k”s
.
	`size
(); jj++) {

346 
cout
 << 
m¬k”_Çmes
[
m¬k”s
[
jj
]] << "\t";

347 
kk
 = 0; kk < 
m¬k”s
.
	`size
(); kk++) {

348 ià(
·œ_wi£_di¡ªûs
[
m¬k”s
[
jj
]][m¬k”s[
kk
]] < 
th»shŞd
) {

350 
cout
 << "#";

352 
cout
 << ".";

354 
cout
 << "\t";

356 
cout
 << 
’dl
;

360 
ii
 = 0; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++) {

361 
cout
 << "==============================================" << 
’dl
;

362 
cout
 << "\t";

363 
veùÜ
<> 
m¬k”s
;

364 
jj
 = 0; jj < 
lškage_group_bšs
[
ii
].
	`size
(); jj++) {

365 
m¬k”s
.
	`š£¹
(m¬k”s.
	`’d
(),

366 
lškage_group_bšs
[
ii
][
Üd”s
[ii][
jj
]].
	`begš
(),

367 
lškage_group_bšs
[
ii
][
Üd”s
[ii][
jj
]].
	`’d
());

369 
	`as£¹
(
m¬k”s
.
	`size
(è=ğ
cÚÃùed_compÚ’ts
[
ii
].size());

370 
jj
 = 0; jj < 
m¬k”s
.
	`size
(); jj++) {

371 
cout
 << 
m¬k”_Çmes
[
m¬k”s
[
jj
]] << "\t";

373 
cout
 << 
’dl
;

374 
jj
 = 0; jj < 
m¬k”s
.
	`size
(); jj++) {

375 
cout
 << 
m¬k”_Çmes
[
m¬k”s
[
jj
]] << "\t";

376 
kk
 = 0; kk < 
m¬k”s
.
	`size
(); kk++) {

377 ià(
·œ_wi£_di¡ªûs
[
m¬k”s
[
jj
]][m¬k”s[
kk
]] < 
th»shŞd
) {

378 
cout
 << 
·œ_wi£_di¡ªûs
[
m¬k”s
[
jj
]][m¬k”s[
kk
]];

380 
cout
 << ".";

382 
cout
 << "\t";

384 
cout
 << 
’dl
;

388 
	}
}

391 
	gg’‘ic_m­
::
	$ÿlcuÏ‹_hÛffdšg_bound
(
´ob_cut_off
) {

392 
t
;

393 ià(
´ob_cut_off
 >= 1)

395 
t
 = 
num”ic_lim™s
<>::
	`max
();

396  
t
;

400 
t
 = 
	`sq¹
((
	`log
(
´ob_cut_off
)è/ (-2*
numb”_of_šdividu®
));

402  
numb”_of_šdividu®
*(0.5-
t
);

403 
	}
};

406 
	gg’‘ic_m­
::
	$şu¡”
() {

407 
numb”_of_»combš©iÚs_cut_off
 = 
	`ÿlcuÏ‹_hÛffdšg_bound
(
şu¡”šg_´ob_cut_off
);

408 
cout
 << "numb”_of_»combš©iÚs_cut_off: " << 
numb”_of_»combš©iÚs_cut_off
 << 
’dl
;

410 
no_m­_th»shŞd
 = 
numb”_of_šdividu®
 * 
df_
->
	`RP
(
no_m­_di¡
);

411 
£t
<> 
un_m­³d_m¬k”s
;

413 ià(
no_m­_th»shŞd
 < 
numb”_of_»combš©iÚs_cut_off
) {

415 
veùÜ
<
boŞ
> 
vis™‹d
;

416 
vis™‹d
.
	`»size
(
numb”_of_loci
);

417 
ii
 = 0; i˜< 
numb”_of_loci
 ; ii++) {

418 
vis™‹d
[
ii
] = 
çl£
;

421 
ii
 = 0 ; i˜< 
numb”_of_loci
 ; ii ++) {

422 ià(
vis™‹d
[
ii
] =ğ
çl£
) {

423 
veùÜ
<> 
üt_cc
;

424 
queue
<> 
fifo_queue
;

425 
fifo_queue
.
	`push
(
ii
);

426 
nÙ
 
fifo_queue
.
	`em±y
()) {

427 
h—d
 = 
fifo_queue
.
	`äÚt
();

428 
fifo_queue
.
	`pİ
();

429 ià(
vis™‹d
[
h—d
] =ğ
çl£
) {

430 
vis™‹d
[
h—d
] = 
Œue
;

431 
üt_cc
.
	`push_back
(
h—d
);

432 
jj
 = 0 ; jj < 
numb”_of_loci
; jj ++) {

433 ià(
·œ_wi£_di¡ªûs
[
h—d
][
jj
] < 
no_m­_th»shŞd
) {

434 
fifo_queue
.
	`push
(
jj
);

439 ià(
üt_cc
.
	`size
(è<ğ
no_m­_size
) {

440 
cÚÃùed_compÚ’ts
.
	`push_back
(
üt_cc
);

441 
un_m­³d_m¬k”s
.
	`š£¹
(
üt_cc
.
	`begš
(), c¹_cc.
	`’d
());

447 
veùÜ
<
boŞ
> 
vis™‹d
;

448 
vis™‹d
.
	`»size
(
numb”_of_loci
);

449 
ii
 = 0; i˜< 
numb”_of_loci
 ; ii++)

451 
vis™‹d
[
ii
] = 
çl£
;

453 
£t
<>::
™”©Ü
 
™”1
 = 
un_m­³d_m¬k”s
.
	`begš
(); i‹r1 !ğun_m­³d_m¬k”s.
	`’d
(); ++iter1) {

454 
vis™‹d
[*
™”1
] = 
Œue
;

457 
ii
 = 0 ; i˜< 
numb”_of_loci
 ; ii ++)

459 ià(
vis™‹d
[
ii
] =ğ
çl£
)

461 
queue
<> 
fifo_queue
;

462 
cÚÃùed_compÚ’ts
.
	`push_back
(
veùÜ
<>());

463 
Ï¡_cc_id
 = 
cÚÃùed_compÚ’ts
.
	`size
() - 1;

464 
fifo_queue
.
	`push
(
ii
);

465 
nÙ
 
fifo_queue
.
	`em±y
()) {

466 
h—d
 = 
fifo_queue
.
	`äÚt
();

467 
fifo_queue
.
	`pİ
();

468 ià(
vis™‹d
[
h—d
] =ğ
çl£
) {

469 
vis™‹d
[
h—d
] = 
Œue
;

470 
cÚÃùed_compÚ’ts
[
Ï¡_cc_id
].
	`push_back
(
h—d
);

471 
jj
 = 0 ; jj < 
numb”_of_loci
; jj ++) {

472 ià((
·œ_wi£_di¡ªûs
[
h—d
][
jj
] < 
numb”_of_»combš©iÚs_cut_off
è
ªd


473 (
vis™‹d
[
jj
] =ğ
çl£
)) {

474 
fifo_queue
.
	`push
(
jj
);

481 
numb”_of_cÚÃùed_compÚ’ts
 = 
cÚÃùed_compÚ’ts
.
	`size
();

482  
cÚÃùed_compÚ’ts
.
	`size
();

483 
	}
}

486 
	gg’‘ic_m­
::
	$cÚd’£_bš
(){

487 
lg_bšs_cÚd’£d
.
	`»size
(
lškage_group_bšs
.
	`size
());

488 
di¡_cÚd’£d
.
	`»size
(
lškage_group_bšs
.
	`size
());

490 
ii
 = 0; i˜< 
lškage_group_bšs
.
	`size
(); ii++) {

491 
lg_bšs_cÚd’£d
[
ii
].
	`push_back
(
lškage_group_bšs
[ii][
Üd”s
[ii][0]]);

492 
üt_bš_id
 = 0;

493 
jj
 = 1; jj < 
Üd”s
[
ii
].
	`size
(); jj++) {

495 ià(
di¡ªû_b‘w“n_adjaûÁ_·œs
[
ii
][
jj
-1] < 
COMBINE_BINS_TH
) {

497 
lg_bšs_cÚd’£d
[
ii
][
üt_bš_id
].
	`š£¹
Ög_bšs_cÚd’£d[ii][üt_bš_id].
	`’d
(),

498 
lškage_group_bšs
[
ii
][
Üd”s
[ii][
jj
]].
	`begš
(),

499 
lškage_group_bšs
[
ii
][
Üd”s
[ii][
jj
]].
	`’d
());

501 
üt_bš_id
 = crt_bin_id + 1;

502 
lg_bšs_cÚd’£d
[
ii
].
	`push_back
(
lškage_group_bšs
[ii][
Üd”s
[ii][
jj
]]);

503 
di¡_cÚd’£d
[
ii
].
	`push_back
(
di¡ªû_b‘w“n_adjaûÁ_·œs
[ii][
jj
-1]);

507 
	}
};

510 
	gg’‘ic_m­
::
	$wr™e_ouut
(
o¡»am
& 
_ouut
)

512 
_ouut
 << ";numb” oàlškaggroups: " << 
numb”_of_cÚÃùed_compÚ’ts
 << 
’dl
;

513 
_ouut
 << ";Thsizoàthlškaggroup ¬e: " << 
’dl
 << ";\t\t";

514 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
 ; ii++)

516 
_ouut
 << (
cÚÃùed_compÚ’ts
[
ii
]).
	`size
() << '\t';

518 
_ouut
 << 
’dl
;

520 
_ouut
 << ";Thnumb” oàbš šƒach†škaggroup: " << 
’dl
 << ";\t\t";

521 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++)

523 
_ouut
 << (
lg_bšs_cÚd’£d
[
ii
]).
	`size
() << '\t';

525 
_ouut
 << 
’dl
 <<ƒndl <<ƒndl;

526 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++)

528 
bufãr1
[100];

529 
bufãr2
[100];

530 
bufãr3
[100];

531 
	`¥rštf
(
bufãr1
,"%.3f",
low”bounds
[
ii
]);

532 
	`¥rštf
(
bufãr2
,"%.3f",
uµ”bounds
[
ii
]);

533 
	`¥rštf
(
bufãr3
,"%.3f",
­´ox_bounds
[
ii
]);

534 
_ouut
 << ";low”bound:" << 
bufãr1
 << " uµ”bound: " << 
bufãr2
;

535 
_ouut
 << " co¡‡á” in™Ÿliz©iÚ:" << 
bufãr3
 << 
’dl
;

536 
_ouut
 << "grou°lg" << 
ii
 << 
’dl
;

537 
_ouut
 << ";BEGINOFGROUP" << 
’dl
;

538 
	`as£¹
(
lg_bšs_cÚd’£d
[
ii
].
	`size
() > 0);

539 
veùÜ
<>::
™”©Ü
 
™”2
 = (
lg_bšs_cÚd’£d
[
ii
][0]).
	`begš
();

540 
™”2
 !ğ(
lg_bšs_cÚd’£d
[
ii
][0]).
	`’d
();

541 
™”2
++) {

542 
_ouut
 << 
m¬k”_Çmes
[*
™”2
] << '\t' << "0.000" << 
’dl
;

544 
cum_di¡
 = 0.0;

545 
	`as£¹
(
lg_bšs_cÚd’£d
[
ii
].
	`size
(è=ğ
di¡_cÚd’£d
[ii].size() + 1);

546 
jj
 = 1; jj < 
lg_bšs_cÚd’£d
[
ii
].
	`size
(); jj++) {

547 
cum_di¡
 = cum_di¡ + 
di¡_cÚd’£d
[
ii
][
jj
-1];

548 
veùÜ
<>::
™”©Ü
 
™”2
 = (
lg_bšs_cÚd’£d
[
ii
][
jj
]).
	`begš
();

549 
™”2
 !ğ(
lg_bšs_cÚd’£d
[
ii
][
jj
]).
	`’d
();

550 
™”2
++) {

551 
bufãr
[100];

552 
	`¥rštf
(
bufãr
, "%.3f", 
cum_di¡
);

553 
_ouut
 << 
m¬k”_Çmes
[*
™”2
] << '\t' << 
bufãr
 << 
’dl
;

556 
_ouut
 << ";ENDOFGROUP" << 
’dl
 <<ƒndl <<ƒndl;

558 
	}
};

	@genetic_map.h

9 #iâdeà
__GENETIC_MAP_H__


10 
	#__GENETIC_MAP_H__


	)

12 
	~<io¡»am
>

13 
	~<f¡»am
>

14 
	~<veùÜ
>

15 
	~<¡ršg
>

16 
	~<cm©h
>

17 
	~<ùime
>

18 
	~"cÚ¡ªts.h
"

19 
	~<queue
>

20 
	~"lškage_group.h
"

23 
usšg
 
Çme¥aû
 
	g¡d
;

26 şas 
	cg’‘ic_m­
{

27 
	m´Ùeùed
:

29 
numb”_of_loci
;

30 
	mnumb”_of_šdividu®
;

31 
	mtÙ®_numb”_of_missšg_obs
;

33 
¡ršg
 
	mpİuÏtiÚ_Çme
;

34 
¡ršg
 
	mdi¡ªû_funùiÚ
;

35 
¡ršg
 
	mpİuÏtiÚ_ty³
;

36 
	mveùÜ
<veùÜ<> > 
	m¿w_m­pšg_d©a
;

37 
	mveùÜ
<
	m¡ršg
> 
	mm¬k”_Çmes
;

38 
	mveùÜ
<
	m¡ršg
> 
	mšdividu®_Çmes
;

41 
DF
* 
	mdf_
;

43 
	mşu¡”šg_´ob_cut_off
;

44 
boŞ
 
	me¡im©iÚ_befÜe_şu¡”šg
;

45 
boŞ
 
	md‘eù_bad_d©a
;

46 
ObjFunc
 
	mobjeùive_funùiÚ
;

50 
	mno_m­_di¡
;

51 
	mno_m­_size
;

52 
	mmissšg_th»shŞd
;

54 
	mveùÜ
<veùÜ<> > 
	m·œ_wi£_di¡ªûs
;

57 
	mnumb”_of_cÚÃùed_compÚ’ts
;

60 
	mveùÜ
<veùÜ<> > 
	mcÚÃùed_compÚ’ts
;

63 
	mveùÜ
<veùÜ<veùÜ<> > > 
	mlškage_group_bšs
;

64 
	mveùÜ
<veùÜ<> > 
	mÜd”s
;

65 
	mveùÜ
<veùÜ<> > 
	mdi¡ªû_b‘w“n_adjaûÁ_·œs
;

67 
	mveùÜ
<> 
	muµ”bounds
;

68 
	mveùÜ
<> 
	mlow”bounds
;

69 
	mveùÜ
<> 
	m­´ox_bounds
;

72 
ÿlcuÏ‹_hÛffdšg_bound
(
´ob_cut_off
);

75 
cÚd’£_m¬k”s_što_bšs
();

78 
şu¡”
();

87 
	mveùÜ
<veùÜ<veùÜ<> > > 
	mlg_bšs_cÚd’£d
;

88 
	mveùÜ
<veùÜ<> > 
	mdi¡_cÚd’£d
;

89 
cÚd’£_bš
();

91 
	mpublic
:

92 
g’‘ic_m­
();

93 ~
g’‘ic_m­
();

96 
»ad_¿w_m­pšg_d©a
(
¡ršg
 
fe_·th
);

99 
dump
();

101 
dump_di¡ªû_m©rix
();

104 
dump_cÚÃùed_compÚ’ts_edges
();

106 
vœtu®
 
g’”©e_m­
() = 0;

108 
wr™e_ouut
(
o¡»am
& 
_ouut
);

	@genetic_map_BCpxFy.cpp

10 
	~"g’‘ic_m­_BCpxFy.h
"

11 
	~<c¡dlib
>

12 
	~<cùy³
>

14 
	gg’‘ic_m­_BCpxFy
::
	$g’_¿w_´ob_d©a
(){

15 
¿w_´ob_d©a_
.
	`»size
(
numb”_of_loci
);

16 
ii
 = 0; i˜< 
numb”_of_loci
; ii++) {

17 
¿w_´ob_d©a_
[
ii
].
	`»size
(
numb”_of_šdividu®
);

19 
ii
 = 0; i˜< 
numb”_of_loci
; ii++) {

20 
jj
 = 0; jj < 
numb”_of_šdividu®
; jj++) {

21 ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'A') {

22 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 1.0;

23 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 0.0;

24 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 0.0;

25 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
çl£
;

26 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'B') {

27 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 0.0;

28 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 1.0;

29 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 0.0;

30 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
çl£
;

31 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'X') {

32 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 0.0;

33 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 0.0;

34 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 1.0;

35 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
çl£
;

36 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == '-') {

37 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 1.0 / 3.0;

38 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 1.0 / 3.0;

39 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 1.0 / 3.0;

40 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
Œue
;

42 
cout
 << "ERROR! inv®id g’Ùy³" << 
’dl
;

43 
	`as£¹
(
çl£
);

47 
	}
};

50 
	gg’‘ic_m­_BCpxFy
::
	$ÿlcuÏ‹_·œ_wi£_di¡ªû
(){

51 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_loci
);

52 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

54 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_loci
);

57 
cout
 << "¡¬ˆÿlcuÏtšg…aœ-wi£ di¡ªû" << 
	`time
(
NULL
);

58 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

60 
cout
 << "fšished oÃ m¬k”" << 
’dl
;

61 
jj
 = 
ii
 + 1 ; jj < 
numb”_of_loci
; jj++)

63 
BCpxFy_di¡_ÿl
 
	`bıxfy_di¡
(
BC_g’”©iÚ_šdex_
, 
F_g’”©iÚ_šdex_
, 
¿w_´ob_d©a_
[
ii
],„aw_´ob_d©a_[
jj
]);

64 
di¡ªû_ii_jj
 = 
bıxfy_di¡
.
	`Di¡
();

65 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
di¡ªû_ii_jj
;

66 
·œ_wi£_di¡ªûs
[
jj
][
ii
] = 
di¡ªû_ii_jj
;

69 
cout
 << "fšished c®cuÏtšgh·œ-wi£ di¡ªû" << 
’dl
;

70 
ii
 = 0; i˜< 
numb”_of_loci
; ii++) {

71 
·œ_wi£_di¡ªûs
[
ii
][ii] = 0.0;

73 
cout
 << 
	`time
(
NULL
è<< 
’dl
;

74 
	}
}

77 
lškage_group_BCpxFy
* 
	gg’‘ic_m­_BCpxFy
::
	$cÚ¡ruù_lškage_group
(
group_id
){

78 
_numb”_of_bšs
 = (
lškage_group_bšs
[
group_id
]).
	`size
();

79 
_numb”_of_šdividu®s
 = 
numb”_of_šdividu®
;

82 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
_¿w_d©a
 ;

83 
veùÜ
<
·œ
<, > > 
_missšg_d©a
;

84 
veùÜ
<> 
_cu¼’t_Üd”
;

86 
_¿w_d©a
.
	`»size
(
_numb”_of_bšs
);

87 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii++) {

88 
_¿w_d©a
[
ii
] = 
¿w_´ob_d©a_
[
lškage_group_bšs
[
group_id
][ii][0]];

89 
jj
 = 0; jj < 
_numb”_of_šdividu®s
; jj++) {

90 ià(
¿w_m­pšg_d©a
[
lškage_group_bšs
[
group_id
][
ii
][0]][
jj
] == '-') {

92 
_missšg_d©a
.
	`push_back
(
	`make_·œ
(
ii
,
jj
));

96 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii ++) {

97 
_cu¼’t_Üd”
.
	`push_back
(
ii
);

99 
lškage_group_BCpxFy
 * 
to_be_»tuºed
 = 
Ãw
 
	`lškage_group_BCpxFy
(
_numb”_of_bšs
,

100 
_numb”_of_šdividu®s
,

101 
BC_g’”©iÚ_šdex_
,

102 
F_g’”©iÚ_šdex_
,

103 
df_
,

104 
_¿w_d©a
,

105 
_cu¼’t_Üd”
,

106 
_missšg_d©a
);

107  
to_be_»tuºed
;

108 
	}
};

111 
lškage_group_BCpxFy
* 
	gg’‘ic_m­_BCpxFy
::
	$cÚ¡ruù_lškage_group_whŞe_m­
(){

112 
_numb”_of_bšs
 = 
numb”_of_loci
;

113 
_numb”_of_šdividu®s
 = 
numb”_of_šdividu®
;

116 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
_¿w_d©a
;

117 
veùÜ
<
·œ
<, > > 
_missšg_d©a
;

118 
veùÜ
<> 
_cu¼’t_Üd”
;

120 
_¿w_d©a
.
	`»size
(
_numb”_of_bšs
);

121 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii++) {

122 
_¿w_d©a
[
ii
] = 
¿w_´ob_d©a_
[ii];

123 
jj
 = 0; jj < 
_numb”_of_šdividu®s
; jj++) {

124 ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == '-') {

125 
_missšg_d©a
.
	`push_back
(
	`make_·œ
(
ii
,
jj
));

129 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii ++) {

130 
_cu¼’t_Üd”
.
	`push_back
(
ii
);

132 
lškage_group_BCpxFy
* 
to_be_»tuºed
 = 
Ãw
 
	`lškage_group_BCpxFy
(
_numb”_of_bšs
,

133 
_numb”_of_šdividu®s
,

134 
BC_g’”©iÚ_šdex_
,

135 
F_g’”©iÚ_šdex_
,

136 
df_
,

137 
_¿w_d©a
,

138 
_cu¼’t_Üd”
,

139 
_missšg_d©a
);

140  
to_be_»tuºed
;

141 
	}
};

144 
	gg’‘ic_m­_BCpxFy
::
	$g’”©e_m­
()

147 
	`g’_¿w_´ob_d©a
();

149 cÚ¡ * 
µl_ty³
 = 
pİuÏtiÚ_ty³
.
	`c_¡r
();

150 
	`as£¹
(
pİuÏtiÚ_ty³
.
	`Ëngth
() >= 6);

151 
	`as£¹
((
µl_ty³
[0] =ğ'B'è
	`Ü
 (ppl_type[0] == 'b'));

152 
	`as£¹
((
µl_ty³
[1] =ğ'C'è
	`Ü
 (ppl_type[1] == 'c'));

153 
	`as£¹
((
µl_ty³
[2] =ğ'A'è
	`Ü
 (ppl_type[2] == 'a') or (ppl_type[2] == 'B') or (ppl_type[2] == 'b'));

156 
¡ršg
 
BC_x_
, 
F_y_
;

157 
pos
 = 0;

158 
ii
 = 3; i˜< 
pİuÏtiÚ_ty³
.
	`Ëngth
(); ii++) {

159 ià(
	`isdig™
(
µl_ty³
[
ii
])){

160 
BC_x_
.
	`push_back
(
µl_ty³
[
ii
]);

162 
pos
 = 
ii
+1;

163 
	`as£¹
((
µl_ty³
[
ii
] =ğ'F'è
	`Ü
 (ppl_type[ii] == 'f'));

167 
ii
 = 
pos
; i˜< 
pİuÏtiÚ_ty³
.
	`Ëngth
(); ii++) {

168 
	`as£¹
(
	`isdig™
(
µl_ty³
[
ii
]));

169 
F_y_
.
	`push_back
(
µl_ty³
[
ii
]);

172 
BC_g’”©iÚ_šdex_
 = 
	`©oi
 (
BC_x_
.
	`c_¡r
());

173 
F_g’”©iÚ_šdex_
 = 
	`©oi
 (
F_y_
.
	`c_¡r
());

175 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_loci
);

176 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

178 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_loci
, 0.0);

185 ià((
tÙ®_numb”_of_missšg_obs
 >ğ
ESTIMATION_BEFORE_CLUSTERING
 * 
numb”_of_loci
 * 
numb”_of_šdividu®
è
ªd


186 (
e¡im©iÚ_befÜe_şu¡”šg
)) {

187 
lškage_group_BCpxFy
 * 
lškage_group_whŞe_m­
 = 
	`cÚ¡ruù_lškage_group_whŞe_m­
();

188 
lškage_group_whŞe_m­
->
	`Üd”_m¬k”s
();

189 cÚ¡ 
veùÜ
<veùÜ<> > & 
Ãw_di¡
 = 
lškage_group_whŞe_m­
-> 
	`g‘_·œ_wi£_di¡ªû
();

190 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

192 
jj
 = 0 ; jj < 
numb”_of_loci
; jj++)

194 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
Ãw_di¡
[ii][jj];

197 
d–‘e
 
lškage_group_whŞe_m­
;

199 
cout
 << "ÿlcuÏtšgh·œ-wi£ hammšg di¡ªû" << 
’dl
;

200 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

201 
cout
 << "fšished c®cuÏtšgh·œ-wi£ hammšg di¡ªû" << 
’dl
;

204 
	`şu¡”
();

205 
cout
 << "found " << 
numb”_of_cÚÃùed_compÚ’ts
 << " cÚÃùed compÚ’ts" << 
’dl
;

207 
	`cÚd’£_m¬k”s_što_bšs
();

209 
Üd”s
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

210 
uµ”bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

211 
low”bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

212 
­´ox_bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

213 
di¡ªû_b‘w“n_adjaûÁ_·œs
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

215 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++)

217 
lškage_group_BCpxFy
 * 
cu¼’t_lškage_group
 = 
	`cÚ¡ruù_lškage_group
(
ii
);

219 
cu¼’t_lškage_group
->
	`Üd”_m¬k”s
();

220 
cu¼’t_lškage_group
->
	`»tuº_Üd”
(
Üd”s
[
ii
],

221 
low”bounds
[
ii
],

222 
uµ”bounds
[
ii
],

223 
­´ox_bounds
[
ii
],

224 
di¡ªû_b‘w“n_adjaûÁ_·œs
[
ii
]);

225 
cu¼’t_lškage_group
->
	`dump
();

226 
d–‘e
 
cu¼’t_lškage_group
;

227 
cout
 <<"fšishedh" << 
ii
+1 << "†škaggroup" << 
’dl
;

232 
	`cÚd’£_bš
();

234 
	`dump_cÚÃùed_compÚ’ts_edges
();

235 
	}
};

	@genetic_map_BCpxFy.h

9 #iâdeà
__GENETIC_MAP_BCPXFY_H__


10 
	#__GENETIC_MAP_BCPXFY_H__


	)

12 
	~"g’‘ic_m­.h
"

13 
	~"lškage_group_BCpxFy.h
"

15 şas 
	cg’‘ic_m­_BCpxFy
: 
public
 
g’‘ic_m­
 {

16 
public
:

17 
	$g’‘ic_m­_BCpxFy
():
	$g’‘ic_m­
(){};

19 
vœtu®
 
	`g’”©e_m­
();

20 
´iv©e
:

21 
	`g’_¿w_´ob_d©a
();

22 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

25 
lškage_group_BCpxFy
* 
	`cÚ¡ruù_lškage_group
(
group_id
);

26 
lškage_group_BCpxFy
* 
	`cÚ¡ruù_lškage_group_whŞe_m­
();

31 
BC_g’”©iÚ_šdex_
;

32 
F_g’”©iÚ_šdex_
;

33 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
¿w_´ob_d©a_
;

34 
	}
};

	@genetic_map_DH.cpp

10 
	~"g’‘ic_m­_DH.h
"

13 
	gg’‘ic_m­_DH
::~
	$g’‘ic_m­_DH
(){

14 
	}
};

16 
	gg’‘ic_m­_DH
::
	$ÿlcuÏ‹_·œ_wi£_di¡ªû
()

18 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_loci
);

19 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

21 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_loci
, 0.0);

24 
cout
 << "¡¬ˆÿlcuÏtšg…aœ-wi£ di¡ªû" << 
	`time
(
NULL
è<< 
’dl
;

25 
ii
 = 0; i˜< 
numb”_of_loci
; ii++)

27 
jj
 = 
ii
 ; jj < 
numb”_of_loci
; jj++)

29 
di¡ªû_ii_jj
 = 0;

30 
nÚe_missšg
 = 0;

31 
kk
 = 0 ; kk < 
numb”_of_šdividu®
; kk++)

34 ià((
¿w_m­pšg_d©a
[
ii
][
kk
] !ğ'-'è
ªd


35 (
¿w_m­pšg_d©a
[
jj
][
kk
] != '-')) {

36 
nÚe_missšg
 =‚one_missing + 1.0;

37 ià(
¿w_m­pšg_d©a
[
ii
][
kk
] !ğ¿w_m­pšg_d©a[
jj
][kk]) {

38 
di¡ªû_ii_jj
 = distance_ii_jj + 1.0;

42 ià(
nÚe_missšg
 < 0.5 * 
numb”_of_šdividu®
) {

43 
cout
 << "caution:oo many missing for…air:("

44 << 
m¬k”_Çmes
[
ii
] << "," << m¬k”_Çmes[
jj
] << ")" << 
’dl
;

47 ià(
nÚe_missšg
 < 0.25 * 
numb”_of_šdividu®
) {

48 
di¡ªû_ii_jj
 = 0.5 * 
numb”_of_šdividu®
;

49 
nÚe_missšg
 = 
numb”_of_šdividu®
;

51 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = (
di¡ªû_ii_jj
 / 
nÚe_missšg
è* 
numb”_of_šdividu®
;

52 
·œ_wi£_di¡ªûs
[
jj
][
ii
] =…air_wise_distances[ii][jj];

55 
cout
 << "fšished c®cuÏtšg…aœ-wi£ di¡ªû:" << 
	`time
(
NULL
è<< 
’dl
;

56 
	}
};

59 
lškage_group_DH
* 
	gg’‘ic_m­_DH
::
	$cÚ¡ruù_lškage_group
(
group_id
)

61 
_numb”_of_bšs
 = (
lškage_group_bšs
[
group_id
]).
	`size
();

62 
_numb”_of_šdividu®s
 = 
numb”_of_šdividu®
;

65 
veùÜ
<veùÜ< > > 
_¿w_d©a
 ;

67 
veùÜ
<
·œ
<, > > 
_missšg_d©a
;

69 
veùÜ
<> 
_cu¼’t_Üd”
;

71 
_¿w_d©a
.
	`»size
(
_numb”_of_bšs
);

72 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii++)

74 
_¿w_d©a
[
ii
].
	`»size
(
_numb”_of_šdividu®s
);

75 
jj
 = 0; jj < 
_numb”_of_šdividu®s
; jj++)

77 ià(
¿w_m­pšg_d©a
[
lškage_group_bšs
[
group_id
][
ii
][0]][
jj
] == 'A')

80 
_¿w_d©a
[
ii
][
jj
] = 1.0;

82 ià(
¿w_m­pšg_d©a
[
lškage_group_bšs
[
group_id
][
ii
][0]][
jj
] == 'B')

85 
_¿w_d©a
[
ii
][
jj
] = 0.0;

90 
_¿w_d©a
[
ii
][
jj
] = 0.5;

91 
_missšg_d©a
.
	`push_back
(
	`make_·œ
(
ii
,
jj
));

95 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii ++)

97 
_cu¼’t_Üd”
.
	`push_back
(
ii
);

99 
veùÜ
<> 
bš_sizes
;

100 
ii
 = 0; i˜< 
_numb”_of_bšs
; ii++) {

101 
bš_sizes
.
	`push_back
(
lškage_group_bšs
[
group_id
][
ii
].
	`size
());

103 
lškage_group_DH
 * 
to_be_»tuºed
 = 
Ãw
 
	`lškage_group_DH
(
_numb”_of_bšs
,

104 
_numb”_of_šdividu®s
,

105 
d‘eù_bad_d©a
,

106 
objeùive_funùiÚ
,

107 
df_
,

108 
_¿w_d©a
,

109 
_cu¼’t_Üd”
,

110 
_missšg_d©a
,

111 
bš_sizes
);

112  
to_be_»tuºed
;

113 
	}
};

116 
lškage_group_DH
* 
	gg’‘ic_m­_DH
::
	$cÚ¡ruù_lškage_group_whŞe_m­
()

118 
_numb”_of_bšs
 = 
numb”_of_loci
;

119 
_numb”_of_šdividu®s
 = 
numb”_of_šdividu®
;

122 
veùÜ
<veùÜ< > > 
_¿w_d©a
 ;

124 
veùÜ
<
·œ
<, > > 
_missšg_d©a
;

126 
veùÜ
<> 
_cu¼’t_Üd”
;

128 
_¿w_d©a
.
	`»size
(
_numb”_of_bšs
);

129 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii++)

131 
_¿w_d©a
[
ii
].
	`»size
(
_numb”_of_šdividu®s
);

132 
jj
 = 0; jj < 
_numb”_of_šdividu®s
; jj++)

134 ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'A')

137 
_¿w_d©a
[
ii
][
jj
] = 1.0;

139 ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'B')

142 
_¿w_d©a
[
ii
][
jj
] = 0.0;

147 
_¿w_d©a
[
ii
][
jj
] = 0.5;

148 
_missšg_d©a
.
	`push_back
(
	`make_·œ
(
ii
,
jj
));

152 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii ++)

154 
_cu¼’t_Üd”
.
	`push_back
(
ii
);

156 
veùÜ
<> 
bš_sizes
;

157 
ii
 = 0; i˜< 
_numb”_of_bšs
; ii++) {

158 
bš_sizes
.
	`push_back
(1);

160 
lškage_group_DH
* 
to_be_»tuºed
 = 
Ãw
 
	`lškage_group_DH
(
_numb”_of_bšs
,

161 
_numb”_of_šdividu®s
,

162 
çl£
,

163 
OBJF_COUNT
,

164 
df_
,

165 
_¿w_d©a
,

166 
_cu¼’t_Üd”
,

167 
_missšg_d©a
,

168 
bš_sizes
);

169  
to_be_»tuºed
;

170 
	}
};

172 
	gg’‘ic_m­_DH
::
	$´št_su¥icious_d©a
(){

173 
cout
 << 
’dl
;

174 
ii
 = 0; i˜< 
su¥icious_d©a
.
	`size
(); ii++) {

175 
cout
 << 
su¥icious_d©a
[
ii
].
fœ¡
;

176 
cout
 << '\t';

177 
cout
 << 
su¥icious_d©a
[
ii
].
£cÚd
;

178 
cout
 << 
’dl
;

180 
	}
};

183 
	gg’‘ic_m­_DH
::
	$g’”©e_m­
()

185 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_loci
);

186 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

188 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_loci
, 0.0);

194 ià((
tÙ®_numb”_of_missšg_obs
 >ğ
ESTIMATION_BEFORE_CLUSTERING
 * 
numb”_of_loci
 * 
numb”_of_šdividu®
è
ªd


195 (
e¡im©iÚ_befÜe_şu¡”šg
)) {

196 
lškage_group_DH
 * 
lškage_group_whŞe_m­
 = 
	`cÚ¡ruù_lškage_group_whŞe_m­
();

197 
lškage_group_whŞe_m­
->
	`Üd”_m¬k”s
();

198 cÚ¡ 
veùÜ
<veùÜ<> > & 
Ãw_di¡
 = 
lškage_group_whŞe_m­
-> 
	`g‘_·œ_wi£_di¡ªû
();

199 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

201 
jj
 = 0 ; jj < 
numb”_of_loci
; jj++)

203 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
Ãw_di¡
[ii][jj];

207 
d–‘e
 
lškage_group_whŞe_m­
;

209 
cout
 << "ÿlcuÏtšgh·œ-wi£ hammšg di¡ªû" << 
’dl
;

210 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

211 
cout
 << "fšished c®cuÏtšgh·œ-wi£ hammšg di¡ªû" << 
’dl
;

214 
	`şu¡”
();

216 
cout
 << "found " << 
numb”_of_cÚÃùed_compÚ’ts
 << " cÚÃùed compÚ’ts" << 
’dl
;

218 
	`cÚd’£_m¬k”s_što_bšs
();

221 
Üd”s
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

222 
uµ”bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

223 
low”bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

224 
­´ox_bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

225 
di¡ªû_b‘w“n_adjaûÁ_·œs
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

227 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++)

229 
lškage_group_DH
 * 
cu¼’t_lškage_group
 = 
	`cÚ¡ruù_lškage_group
(
ii
);

231 
cu¼’t_lškage_group
->
	`Üd”_m¬k”s
();

232 
cu¼’t_lškage_group
->
	`»tuº_Üd”
(
Üd”s
[
ii
],

233 
low”bounds
[
ii
],

234 
uµ”bounds
[
ii
],

235 
­´ox_bounds
[
ii
],

236 
di¡ªû_b‘w“n_adjaûÁ_·œs
[
ii
]);

237 
veùÜ
<
·œ
<, > > 
bad_d©a_ii
;

238 
cu¼’t_lškage_group
->
	`bad_g’Ùy³s
(
bad_d©a_ii
);

239 
jj
 = 0; jj < 
bad_d©a_ii
.
	`size
(); jj++) {

240 
bš_id
 = 
bad_d©a_ii
[
jj
].
fœ¡
;

241 
šdi_id
 = 
bad_d©a_ii
[
jj
].
£cÚd
;

242 
kk
 = 0; kk < 
lškage_group_bšs
[
ii
][
bš_id
].
	`size
(); kk++) {

243 
¡ršg
 
m¬k”_Çme
 = 
m¬k”_Çmes
[
lškage_group_bšs
[
ii
][
bš_id
][
kk
]];

244 
¡ršg
 
šdi_Çme
 = 
šdividu®_Çmes
[
šdi_id
];

245 
su¥icious_d©a
.
	`push_back
(
	`make_·œ
(
m¬k”_Çme
, 
šdi_Çme
));

248 
cu¼’t_lškage_group
->
	`dump
();

249 
d–‘e
 
cu¼’t_lškage_group
;

250 
cout
 <<"fšishedh" << 
ii
+1 << "†škaggroup" << 
’dl
;

255 
	`cÚd’£_bš
();

256 
cout
 << "su¥iciou d©¨d‘eùed by ou¸®gÜ™hm" << 
’dl
;

257 
	`´št_su¥icious_d©a
();

258 
cout
 << "doubË cros ov” ba£d oÀthcu¼’ˆÜd”" << 
’dl
;

259 
	`´št_doubË_üoss_ov”s
();

262 
	}
};

265 
	gg’‘ic_m­_DH
::
	$´št_doubË_üoss_ov”s
(){

266 
ii
 = 0; i˜< 
lg_bšs_cÚd’£d
.
	`size
(); ii++) {

267 ià(
lg_bšs_cÚd’£d
[
ii
].
	`size
() < 3) {

270 
jj
 = 0; jj < 
lg_bšs_cÚd’£d
[
ii
].
	`size
(); jj++){

271 ià(
lg_bšs_cÚd’£d
[
ii
][
jj
].
	`size
() > 1) {

274 
m¬k”_id
 = 
lg_bšs_cÚd’£d
[
ii
][
jj
][0];

275 
´e_m¬k”_id
 = -1;

276 ià(
jj
 == 0){

277 
´e_m¬k”_id
 = 
lg_bšs_cÚd’£d
[
ii
][1][0];

279 
´e_m¬k”_id
 = 
lg_bšs_cÚd’£d
[
ii
][
jj
 - 1][0];

282 
Ãxt_m¬k”_id
 = -1;

283 ià(
jj
 =ğ
lg_bšs_cÚd’£d
[
ii
].
	`size
() - 1) {

284 
Ãxt_m¬k”_id
 = 
lg_bšs_cÚd’£d
[
ii
][lg_bšs_cÚd’£d[ii].
	`size
() - 2][0];

286 
Ãxt_m¬k”_id
 = 
lg_bšs_cÚd’£d
[
ii
][
jj
 + 1][0];

289 
kk
 = 0; kk < 
numb”_of_šdividu®
; kk++) {

290 ià(
¿w_m­pšg_d©a
[
m¬k”_id
][
kk
] == '-') {

293 ià((
¿w_m­pšg_d©a
[
m¬k”_id
][
kk
] !ğ¿w_m­pšg_d©a[
´e_m¬k”_id
][kk]è
ªd


294 (
¿w_m­pšg_d©a
[
m¬k”_id
][
kk
] !ğ¿w_m­pšg_d©a[
Ãxt_m¬k”_id
][kk])) {

296 
cout
 << 
m¬k”_Çmes
[
m¬k”_id
] << "," << 
šdividu®_Çmes
[
kk
] << 
’dl
;

301 
	}
}

	@genetic_map_DH.h

9 #iâdeà
__GENETIC_MAP_DH_H__


10 
	#__GENETIC_MAP_DH_H__


	)

12 
	~<io¡»am
>

13 
	~<f¡»am
>

14 
	~<veùÜ
>

15 
	~<¡ršg
>

16 
	~<cm©h
>

17 
	~<ùime
>

18 
	~"cÚ¡ªts.h
"

19 
	~<queue
>

20 
	~"lškage_group_DH.h
"

21 
	~"g’‘ic_m­.h
"

24 
usšg
 
Çme¥aû
 
	g¡d
;

26 şas 
	cg’‘ic_m­_DH
: 
public
 
g’‘ic_m­
 {

27 
´iv©e
:

28 
veùÜ
<
·œ
<
¡ršg
, 
	m¡ršg
> > 
	msu¥icious_d©a
;

30 
ÿlcuÏ‹_·œ_wi£_di¡ªû
();

33 
lškage_group_DH
* 
cÚ¡ruù_lškage_group
(
group_id
);

34 
lškage_group_DH
* 
cÚ¡ruù_lškage_group_whŞe_m­
();

35 
´št_su¥icious_d©a
();

36 
	mpublic
:

37 
	$g’‘ic_m­_DH
():
	$g’‘ic_m­
(){};

38 ~
	`g’‘ic_m­_DH
();

39 
vœtu®
 
	`g’”©e_m­
();

40 
	`´št_doubË_üoss_ov”s
();

41 
	}
};

	@genetic_map_RIL.cpp

10 
	~"g’‘ic_m­_RIL.h
"

11 
	~<c¡dlib
>

13 
	gg’‘ic_m­_RIL
::
	$g’_¿w_´ob_d©a
(){

14 
¿w_´ob_d©a_
.
	`»size
(
numb”_of_loci
);

15 
ii
 = 0; i˜< 
numb”_of_loci
; ii++) {

16 
¿w_´ob_d©a_
[
ii
].
	`»size
(
numb”_of_šdividu®
);

18 
ii
 = 0; i˜< 
numb”_of_loci
; ii++) {

19 
jj
 = 0; jj < 
numb”_of_šdividu®
; jj++) {

20 ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'A') {

21 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 1.0;

22 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 0.0;

23 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 0.0;

24 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
çl£
;

25 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'B') {

26 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 0.0;

27 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 1.0;

28 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 0.0;

29 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
çl£
;

30 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == 'X') {

31 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 0.0;

32 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 0.0;

33 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 1.0;

34 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
çl£
;

35 } ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == '-') {

36 
¿w_´ob_d©a_
[
ii
][
jj
].
A
 = 1.0 / 3.0;

37 
¿w_´ob_d©a_
[
ii
][
jj
].
B
 = 1.0 / 3.0;

38 
¿w_´ob_d©a_
[
ii
][
jj
].
AB
 = 1.0 / 3.0;

39 
¿w_´ob_d©a_
[
ii
][
jj
].
missšg
 = 
Œue
;

41 
cout
 << "ERROR! inv®id g’Ùy³" << 
’dl
;

42 
	`as£¹
(
çl£
);

46 
	}
};

49 
	gg’‘ic_m­_RIL
::
	$ÿlcuÏ‹_·œ_wi£_di¡ªû
(){

50 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_loci
);

51 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

53 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_loci
);

56 
cout
 << "¡¬ˆÿlcuÏtšg…aœ-wi£ di¡ªû" << 
	`time
(
NULL
);

57 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

59 
cout
 << "fšished oÃ m¬k”" << 
’dl
;

60 
jj
 = 
ii
 + 1 ; jj < 
numb”_of_loci
; jj++)

62 
RIL_di¡_ÿl
 
	`r_di¡
(
g’”©iÚ_šdex_
, 
¿w_´ob_d©a_
[
ii
],„aw_´ob_d©a_[
jj
]);

63 
di¡ªû_ii_jj
 = 
r_di¡
.
	`Di¡
();

64 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
di¡ªû_ii_jj
;

65 
·œ_wi£_di¡ªûs
[
jj
][
ii
] = 
di¡ªû_ii_jj
;

68 
cout
 << "fšished c®cuÏtšgh·œ-wi£ di¡ªû" << 
’dl
;

69 
ii
 = 0; i˜< 
numb”_of_loci
; ii++) {

70 
·œ_wi£_di¡ªûs
[
ii
][ii] = 0.0;

72 
cout
 << 
	`time
(
NULL
è<< 
’dl
;

73 
	}
}

76 
lškage_group_RIL
* 
	gg’‘ic_m­_RIL
::
	$cÚ¡ruù_lškage_group
(
group_id
){

77 
_numb”_of_bšs
 = (
lškage_group_bšs
[
group_id
]).
	`size
();

78 
_numb”_of_šdividu®s
 = 
numb”_of_šdividu®
;

81 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
_¿w_d©a
 ;

82 
veùÜ
<
·œ
<, > > 
_missšg_d©a
;

83 
veùÜ
<> 
_cu¼’t_Üd”
;

85 
_¿w_d©a
.
	`»size
(
_numb”_of_bšs
);

86 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii++) {

87 
_¿w_d©a
[
ii
] = 
¿w_´ob_d©a_
[
lškage_group_bšs
[
group_id
][ii][0]];

88 
jj
 = 0; jj < 
_numb”_of_šdividu®s
; jj++) {

89 ià(
¿w_m­pšg_d©a
[
lškage_group_bšs
[
group_id
][
ii
][0]][
jj
] == '-') {

91 
_missšg_d©a
.
	`push_back
(
	`make_·œ
(
ii
,
jj
));

95 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii ++) {

96 
_cu¼’t_Üd”
.
	`push_back
(
ii
);

98 
lškage_group_RIL
 * 
to_be_»tuºed
 = 
Ãw
 
	`lškage_group_RIL
(
_numb”_of_bšs
,

99 
_numb”_of_šdividu®s
,

100 
g’”©iÚ_šdex_
,

101 
df_
,

102 
_¿w_d©a
,

103 
_cu¼’t_Üd”
,

104 
_missšg_d©a
);

105  
to_be_»tuºed
;

106 
	}
};

109 
lškage_group_RIL
* 
	gg’‘ic_m­_RIL
::
	$cÚ¡ruù_lškage_group_whŞe_m­
(){

110 
_numb”_of_bšs
 = 
numb”_of_loci
;

111 
_numb”_of_šdividu®s
 = 
numb”_of_šdividu®
;

114 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
_¿w_d©a
;

115 
veùÜ
<
·œ
<, > > 
_missšg_d©a
;

116 
veùÜ
<> 
_cu¼’t_Üd”
;

118 
_¿w_d©a
.
	`»size
(
_numb”_of_bšs
);

119 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii++) {

120 
_¿w_d©a
[
ii
] = 
¿w_´ob_d©a_
[ii];

121 
jj
 = 0; jj < 
_numb”_of_šdividu®s
; jj++) {

122 ià(
¿w_m­pšg_d©a
[
ii
][
jj
] == '-') {

123 
_missšg_d©a
.
	`push_back
(
	`make_·œ
(
ii
,
jj
));

127 
ii
 = 0 ; i˜< 
_numb”_of_bšs
; ii ++) {

128 
_cu¼’t_Üd”
.
	`push_back
(
ii
);

130 
lškage_group_RIL
* 
to_be_»tuºed
 = 
Ãw
 
	`lškage_group_RIL
(
_numb”_of_bšs
,

131 
_numb”_of_šdividu®s
,

132 
g’”©iÚ_šdex_
,

133 
df_
,

134 
_¿w_d©a
,

135 
_cu¼’t_Üd”
,

136 
_missšg_d©a
);

137  
to_be_»tuºed
;

138 
	}
};

141 
	gg’‘ic_m­_RIL
::
	$g’”©e_m­
()

144 
	`g’_¿w_´ob_d©a
();

146 cÚ¡ * 
µl_ty³
 = 
pİuÏtiÚ_ty³
.
	`c_¡r
();

147 
	`as£¹
(
pİuÏtiÚ_ty³
.
	`Ëngth
() >= 4);

148 
	`as£¹
(
µl_ty³
[0] == 'R');

149 
	`as£¹
(
µl_ty³
[1] == 'I');

150 
	`as£¹
(
µl_ty³
[2] == 'L');

152 
g’”©iÚ_šdex_
 = 
	`©oi
(&(
µl_ty³
[3]));

154 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_loci
);

155 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

157 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_loci
, 0.0);

164 ià((
tÙ®_numb”_of_missšg_obs
 >ğ
ESTIMATION_BEFORE_CLUSTERING
 * 
numb”_of_loci
 * 
numb”_of_šdividu®
è
ªd


165 (
e¡im©iÚ_befÜe_şu¡”šg
)) {

166 
lškage_group_RIL
 * 
lškage_group_whŞe_m­
 = 
	`cÚ¡ruù_lškage_group_whŞe_m­
();

167 
lškage_group_whŞe_m­
->
	`Üd”_m¬k”s
();

168 cÚ¡ 
veùÜ
<veùÜ<> > & 
Ãw_di¡
 = 
lškage_group_whŞe_m­
-> 
	`g‘_·œ_wi£_di¡ªû
();

169 
ii
 = 0 ; i˜< 
numb”_of_loci
; ii++)

171 
jj
 = 0 ; jj < 
numb”_of_loci
; jj++)

173 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
Ãw_di¡
[ii][jj];

176 
d–‘e
 
lškage_group_whŞe_m­
;

178 
cout
 << "ÿlcuÏtšgh·œ-wi£ hammšg di¡ªû" << 
’dl
;

179 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

180 
cout
 << "fšished c®cuÏtšgh·œ-wi£ hammšg di¡ªû" << 
’dl
;

183 
	`şu¡”
();

184 
cout
 << "found " << 
numb”_of_cÚÃùed_compÚ’ts
 << " cÚÃùed compÚ’ts" << 
’dl
;

186 
	`cÚd’£_m¬k”s_što_bšs
();

188 
Üd”s
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

189 
uµ”bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

190 
low”bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

191 
­´ox_bounds
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

192 
di¡ªû_b‘w“n_adjaûÁ_·œs
.
	`»size
(
numb”_of_cÚÃùed_compÚ’ts
);

194 
ii
 = 0 ; i˜< 
numb”_of_cÚÃùed_compÚ’ts
; ii++)

196 
lškage_group_RIL
 * 
cu¼’t_lškage_group
 = 
	`cÚ¡ruù_lškage_group
(
ii
);

198 
cu¼’t_lškage_group
->
	`Üd”_m¬k”s
();

199 
cu¼’t_lškage_group
->
	`»tuº_Üd”
(
Üd”s
[
ii
],

200 
low”bounds
[
ii
],

201 
uµ”bounds
[
ii
],

202 
­´ox_bounds
[
ii
],

203 
di¡ªû_b‘w“n_adjaûÁ_·œs
[
ii
]);

204 
cu¼’t_lškage_group
->
	`dump
();

205 
d–‘e
 
cu¼’t_lškage_group
;

206 
cout
 <<"fšishedh" << 
ii
+1 << "†škaggroup" << 
’dl
;

211 
	`cÚd’£_bš
();

213 
	`dump_cÚÃùed_compÚ’ts_edges
();

214 
	}
};

	@genetic_map_RIL.h

9 #iâdeà
__GENETIC_MAP_RIL_H__


10 
	#__GENETIC_MAP_RIL_H__


	)

12 
	~"g’‘ic_m­.h
"

13 
	~"lškage_group_RIL.h
"

15 şas 
	cg’‘ic_m­_RIL
: 
public
 
g’‘ic_m­
 {

16 
public
:

17 
	$g’‘ic_m­_RIL
():
	$g’‘ic_m­
(){};

19 
vœtu®
 
	`g’”©e_m­
();

20 
´iv©e
:

21 
	`g’_¿w_´ob_d©a
();

22 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

25 
lškage_group_RIL
* 
	`cÚ¡ruù_lškage_group
(
group_id
);

26 
lškage_group_RIL
* 
	`cÚ¡ruù_lškage_group_whŞe_m­
();

31 
g’”©iÚ_šdex_
;

32 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
¿w_´ob_d©a_
;

33 
	}
};

	@linkage_group.cpp

10 
	~"lškage_group.h
"

11 
	~<lim™s
>

13 
boŞ
 
cmp
(
·œ
<,…aœ<,> > 
–em’t1
,…aœ<,…aœ<,> > 
–em’t2
)

15  
	g–em’t1
.
	gfœ¡
 < 
	g–em’t2
.first;

19 cÚ¡ 
	gveùÜ
<veùÜ<> >& 
	glškage_group
::
	$g‘_·œ_wi£_di¡ªû
() const

21  
·œ_wi£_di¡ªûs
;

22 
	}
};

26 
	glškage_group
::
g’”©e_di¡ªû_š_cM
(
veùÜ
<veùÜ<> >& 
di¡ªû_š_cM
){

27 
di¡ªû_š_cM
.
»size
(
numb”_of_bšs
);

28 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

29 
	gdi¡ªû_š_cM
[
ii
].
»size
(
numb”_of_bšs
);

31 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

32 
	gjj
 = 0; jj < 
	gnumb”_of_bšs
; jj++) {

33 
	gr
 = 
·œ_wi£_di¡ªûs
[
ii
][
jj
] / 
numb”_of_šdividu®s
;

34 ià(
	gr
 >= 0.5) {

35 
r
 =„ - 
ZERO_PLUS
;

37 
	gdi¡ªû_š_cM
[
ii
][
jj
] = 
df
->
CM
(
r
);

43 
	glškage_group
::
g’”©e_di¡ªû_š_ML
(
veùÜ
<veùÜ<> >& 
di¡ªû_š_ML
){

44 
di¡ªû_š_ML
.
»size
(
numb”_of_bšs
);

45 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

46 
	gdi¡ªû_š_ML
[
ii
].
»size
(
numb”_of_bšs
);

48 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

49 
	gjj
 = 0; jj < 
	gnumb”_of_bšs
; jj++) {

50 
	gr
 = 
·œ_wi£_di¡ªûs
[
ii
][
jj
] / 
numb”_of_šdividu®s
;

51 ià(
	gr
 >= 0.5) {

52 
r
 =„ - 
ZERO_PLUS
;

54 ià(
	gr
 == 0.0) {

55 
di¡ªû_š_ML
[
ii
][
jj
] = 0.0;

57 
	gdi¡ªû_š_ML
[
ii
][
jj
] = -(
r
 * 
log
(r) + (1 -„) *†og(1 -„));

64 
	glškage_group
::
	$dump_commÚ
() const {

65 
cout
 << "numb” oàbšs:" << 
numb”_of_bšs
 << 
’dl
;

66 
cout
 << "numb” oàšdividu®s:" << 
numb”_of_šdividu®s
 << 
’dl
;

67 
cout
 << "cu¼’t_Üd”:" << 
’dl
;

68 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

70 
cout
 << 
cu¼’t_Üd”
[
ii
] << ',' ;

72 
cout
 << 
’dl
;

74 
cout
 << "low”bound: " << 
MST_low”_bound
 << "huµ”bound:" << 
cu¼’t_uµ”_bound
 << 
’dl
;

77 
cout
 << "ThMST:" << 
’dl
;

78 
ii
 = 0 ; i˜< 
numb”_of_bšs
 ; ii++)

80 
cout
 << 
MST
[
ii
] << ',' ;

83 
veùÜ
<> 
	`tmp_couÁ
(
numb”_of_bšs
, 0);

84 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

86 
tmp_couÁ
[
MST
[
ii
]] =mp_count[MST[ii]] + 1;

88 
cout
 << 
’dl
;

90 
cout
 << "Thšdeg»fÜƒach oàthv”tiûs: " << 
’dl
;

91 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

93 
cout
 << 
tmp_couÁ
[
ii
] << ',';

96 
cout
 << 
’dl
;

98 
cout
 << "df function:";

99 
df
->
	`´št_df_Çme
();

100 
cout
 << 
’dl
;

101 
cout
 << "thdi¡ªû b‘w“ÀcÚ£cutiv·œs:" << 
’dl
;

102 
ii
 = 1 ; i˜< 
numb”_of_bšs
; ii++)

104 
cout
 << 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
]][current_order[ii-1]] << ',';

106 
cout
 << 
’dl
;

107 
	}
};

110 
	glškage_group
::
bad_g’Ùy³s
(
veùÜ
<
·œ
<,> >& bad_genotypes) const{

111 
	gbad_g’Ùy³s
.
ş—r
();

112 
	gii
 = 0; i˜< 
	gsu¥icious_d©a
.
size
(); ii++) {

113 
	gbad_g’Ùy³s
.
push_back
(
su¥icious_d©a
[
ii
]);

118 
	glškage_group
::
	$dump_di¡ªû_m©rix
() {

119 
bufãr
[10];

120 
cout
 << "di¡ªû m©rix w™hš†škage_group" << 
’dl
;

121 
cout
 << "m©rix dim’siÚ:" << 
·œ_wi£_di¡ªûs
.
	`size
(è<< 
’dl
;

122 
ii
 = 0; i˜< 
·œ_wi£_di¡ªûs
.
	`size
(); ii++) {

123 
jj
 = 0; jj < 
·œ_wi£_di¡ªûs
[
ii
].
	`size
(); jj++) {

124 
	`¥rštf
(
bufãr
, "%.2à", 
·œ_wi£_di¡ªûs
[
ii
][
jj
]);

125 
cout
 << 
bufãr
;

127 
cout
 << 
’dl
;

129 
	}
}

132 
	glškage_group
::
»tuº_Üd”
(
veùÜ
<>& 
out_Üd”
,

133 & 
_low”bound
,

134 & 
_uµ”_bound
,

135 & 
_co¡_aá”_š™Ÿliz©iÚ
,

136 
veùÜ
<> & 
_di¡ªûs
) const {

137 
	gout_Üd”
 = 
cu¼’t_Üd”
;

138 
	g_low”bound
 = 
MST_low”_bound
;

139 
	g_uµ”_bound
 = 
cu¼’t_uµ”_bound
;

140 
	g_co¡_aá”_š™Ÿliz©iÚ
 = 
co¡_aá”_š™Ÿliz©iÚ
;

141 
	g_di¡ªûs
.
ş—r
();

142 
	g_di¡ªûs
.
»size
(
numb”_of_bšs
-1);

143 
	gii
 = 1 ; i˜< 
	gnumb”_of_bšs
; ii++)

145 
	g_di¡ªûs
[
ii
-1] = 
df
->
CM
(
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[ii]][cu¼’t_Üd”[ii-1]] /
numb”_of_šdividu®s
);

	@linkage_group.h

10 #iâdeà
__LINKAGE_GROUP_H__


11 
	#__LINKAGE_GROUP_H__


	)

13 
	~<io¡»am
>

14 
	~<f¡»am
>

15 
	~<veùÜ
>

16 
	~<¡ršg
>

17 
	~<cm©h
>

18 
	~<ùime
>

19 
	~<ÿs£¹
>

20 
	~<queue
>

21 
	~<ut™y
>

22 
	~<£t
>

23 
	~<®gÜ™hm
>

24 
	~"cÚ¡ªts.h
"

26 
usšg
 
Çme¥aû
 
	g¡d
;

28 
boŞ
 
cmp
(
·œ
<,…aœ<,> > 
–em’t1
,…aœ<,…aœ<,> > 
–em’t2
);

30 şas 
	cDF
{

31 
	mpublic
:

32 
vœtu®
 
	$CM
(
½
) const {

33 
cout
 << "ERROR, s³cifiøDF should bu£d in¡—d" << 
’dl
;

34 
	`as£¹
(
çl£
);

37 
vœtu®
 
	$RP
(
cm
) const {

38 
cout
 << "ERROR, s³cifiøDF should bu£d in¡—d" << 
’dl
;

39 
	`as£¹
(
çl£
);

41 
	}
};

42 
vœtu®
 
	$´št_df_Çme
() const {

43 
cout
 << "g’”iødf" << 
’dl
;

44 
	}
};

47 şas 
	cDF_H®dªe
:
public
 
DF
{

48 
public
:

49 
vœtu®
 
	$CM
(
½
) const {

50 ià(
½
 >= 0.5)„p = 0.5 - 0.000001;

51  -50.0 * 
	`log
(1 - 2 * 
½
);

53 
vœtu®
 
	$RP
(
cm
) const {

54  -0.5 * (
	`exp
(-
cm
 / 50.0) - 1.0);

55 
	}
};

56 
vœtu®
 
	$´št_df_Çme
() const {

57 
cout
 << "H®dªe" << 
’dl
;

58 
	}
};

61 şas 
	cDF_Ko§mbi
:
public
 
DF
{

62 
public
:

63 
vœtu®
 
	$CM
(
½
) const {

64 ià(
½
 >= 0.5)„p = 0.5 - 0.000001;

65  25.0 * 
	`log
((1 + 2.0 * 
½
) / (1 - 2.0 *„p));

67 
vœtu®
 
	$RP
(
cm
) const {

68  0.5 * ((
	`exp
(
cm
 / 25) - 1) / (exp(cm / 25) + 1));

69 
	}
};

70 
vœtu®
 
	$´št_df_Çme
() const {

71 
cout
 << "Ko§mbi" << 
’dl
;

72 
	}
};

75 şas 
	clškage_group
 {

76 
	mpublic
:

77 cÚ¡ 
veùÜ
<veùÜ<> >& 
	$g‘_·œ_wi£_di¡ªû
() const;

78 
	`»tuº_Üd”
(
veùÜ
<>& 
out_Üd”
,

79 & 
_low”bound
,

80 & 
_uµ”_bound
,

81 & 
_co¡_aá”_š™Ÿliz©iÚ
,

82 
veùÜ
<> & 
_di¡ªûs
) const;

83 
	$dump_commÚ
() const;

84 
	`bad_g’Ùy³s
(
veùÜ
<
·œ
<,> >& 
bad_g’Ùy³s
) const;

85 
	`dump_di¡ªû_m©rix
();

86 
´Ùeùed
:

89 
	`g’”©e_di¡ªû_š_cM
(
veùÜ
<veùÜ<> >& 
di¡ªû_š_cM
);

90 
	`g’”©e_di¡ªû_š_ML
(
veùÜ
<veùÜ<> >& 
di¡ªû_š_ML
);

92 
boŞ
 
d‘eù_bad_d©a
;

93 
ObjFunc
 
objeùive_funùiÚ
;

94 
numb”_of_bšs
;

95 
numb”_of_šdividu®s
;

101 
veùÜ
<veùÜ<> > 
·œ_wi£_di¡ªûs
;

102 
veùÜ
<
·œ
<,> > 
missšg_d©a
;

103 
veùÜ
<> 
bš_sizes
;

107 
veùÜ
<
·œ
<,> > 
su¥icious_d©a
;

109 
veùÜ
<> 
cu¼’t_Üd”
;

110 
veùÜ
<> 
MST
;

111 
MST_low”_bound
;

112 
cu¼’t_uµ”_bound
;

113 
co¡_aá”_š™Ÿliz©iÚ
;

118 
DF
* 
df
;

	@linkage_group_BCpxFy.cpp

10 
	~"lškage_group_BCpxFy.h
"

13 
	gBCpxFy_di¡_ÿl
::
	$couÁ_şass
(){

14 
CC_
 = 0.0; 
DD_
 = 0.0; 
EE_
 = 0.0; 
FG_
 = 0.0;

15 
•sÚ
 = 0.000001;

16 
ii
 = 0; i˜< 
num_of_šdividu®s_
; ii++) {

17 
m¬k”1_tÙ®
 = 
m¬k”1_
[
ii
].
A
 + m¬k”1_[ii].
B
 + m¬k”1_[ii].
AB
;

18 
m¬k”2_tÙ®
 = 
m¬k”2_
[
ii
].
A
 + m¬k”2_[ii].
B
 + m¬k”2_[ii].
AB
;

19 
	`as£¹
(
m¬k”1_tÙ®
 < 1 + 
•sÚ
);

20 
	`as£¹
(
m¬k”2_tÙ®
 < 1 + 
•sÚ
);

21 
	`as£¹
(
m¬k”1_tÙ®
 > 1 - 
•sÚ
);

22 
	`as£¹
(
m¬k”2_tÙ®
 > 1 - 
•sÚ
);

24 
ii
 = 0; i˜< 
num_of_šdividu®s_
; ii++) {

25 ià((
nÙ
 
m¬k”1_
[
ii
].
missšg
è
	`ªd
 (nÙ 
m¬k”2_
[ii].missing)) {

26 
num_of_eff_šdividu®s_
++;

27 
CC_
 = CC_ + 
m¬k”1_
[
ii
].
A
 * 
m¬k”2_
[ii].A + m¬k”1_[ii].
B
 * marker2_[ii].B;

28 
DD_
 = DD_ + 
m¬k”1_
[
ii
].
A
 * 
m¬k”2_
[ii].
B
 + marker1_[ii].B * marker2_[ii].A;

29 
EE_
 = EE_ + 
m¬k”1_
[
ii
].
AB
 * 
m¬k”2_
[ii].
A
 + m¬k”1_[ii].AB * m¬k”2_[ii].
B


30 + 
m¬k”2_
[
ii
].
AB
 * 
m¬k”1_
[ii].
A
 + m¬k”2_[ii].AB * m¬k”1_[ii].
B
;

31 
FG_
 = FG_ + 
m¬k”1_
[
ii
].
AB
 * 
m¬k”2_
[ii].AB;

34 
tÙ®
 = 
CC_
 + 
DD_
 + 
EE_
 + 
FG_
;

36 
	`as£¹
(
tÙ®
 < 
num_of_eff_šdividu®s_
 + 
•sÚ
);

37 
	`as£¹
(
tÙ®
 > 
num_of_eff_šdividu®s_
 - 
•sÚ
);

38 
	}
};

41 
	gBCpxFy_di¡_ÿl
::
	$uµ”_bound
(){

42 
R
 = (
DD_
 + 
EE_
 + 
FG_
è/ (
CC_
 + DD_ + EE_ + FG_);

43 
d–_uµ”_bound_
 = 
R
 / (2 - 2 * R);

44 ià(
d–_uµ”_bound_
 > 0.5) delta_upper_bound_ = 0.5;

45 
	}
};

48 
	gBCpxFy_di¡_ÿl
::
	$low”_bound
(){

49 
R
 = 
DD_
 / (
CC_
 + DD_ + 
EE_
 + 
FG_
);

50 
d–_low”_bound_
 = 
R
 / (2 - 2 * R);

51 ià(
d–_low”_bound_
 > 0.5) delta_lower_bound_ = 0.5;

52 
	}
};

55 
	gBCpxFy_di¡_ÿl
::
	$ex³ùed_CDEFG
(
d–
,

56 & 
C
,

57 & 
D
,

58 & 
E
,

59 & 
F
,

60 & 
G
) const {

61 
	`as£¹
((
BC_g’”©iÚ_šdex_
 >ğ1è
	`ªd
 (BC_generation_index_ <= 99));

62 
	`as£¹
((
F_g’”©iÚ_šdex_
 >ğ0è
	`ªd
 (F_generation_index_ <= 99));

65 
CC
 = 0.0;

66 
DD
 = 0.0;

67 
EE
 = 0.0;

68 
FF
 = 1.0;

69 
GG
 = 0.0;

71 
i
 = 0; i < 
BC_g’”©iÚ_šdex_
; i++) {

72 
CC_´ime
 = 
CC
 + 0.5 * 
EE
 + 0.5 * (1 - 
d–
è* 
FF
;

73 
DD_´ime
 = 0;

74 
EE_´ime
 = 0.5 * 
EE
 + 0.5 * 
d–
 * 
FF
;

75 
FF_´ime
 = 0.5 * (1 - 
d–
è* 
FF
;

76 
GG_´ime
 = 0;

77 
CC
 = 
CC_´ime
; 
DD
 = 
DD_´ime
; 
EE
 = 
EE_´ime
; 
FF
 = 
FF_´ime
; 
GG
 = 
GG_´ime
;

81 
ii
 = 0; i˜< 
F_g’”©iÚ_šdex_
; ii++) {

82 
CC_´ime
 = 
CC
 + 0.5 * 
EE
 + 0.25 * (1 - 
d–
è* (1 - d–è* 
FF
 + 0.25 * d– * d– * 
GG
;

83 
DD_´ime
 = 
DD
 + 0.5 * 
EE
 + 0.25 * 
d–
 * d– * 
FF
 + 0.25 * (1 - d–è* (1 - d–è* 
GG
;

84 
EE_´ime
 = 0.5 * 
EE
 + 0.5 * 
d–
 * (1 - d–è* (
FF
 + 
GG
);

85 
FF_´ime
 = 0.5 * (1 - 
d–
è* (1 - d–è* 
FF
 + 0.5 * d– * d– * 
GG
;

86 
GG_´ime
 = 0.5 * 
d–
 * d– * 
FF
 + 0.5 * (1 - d–è* (1 - d–è* 
GG
;

87 
CC
 = 
CC_´ime
; 
DD
 = 
DD_´ime
; 
EE
 = 
EE_´ime
; 
FF
 = 
FF_´ime
; 
GG
 = 
GG_´ime
;

89 
•sÚ
 = 0.000001;

90 
tÙ®
 = 2 * 
CC
 + 2 * 
DD
 + 4 * 
EE
 + 
FF
 + 
GG
;

91 
	`as£¹
(
tÙ®
 < 1 + 
•sÚ
);

92 
	`as£¹
(
tÙ®
 > 1 - 
•sÚ
);

93 
C
 = 
CC
; 
D
 = 
DD
; 
E
 = 
EE
; 
F
 = 
FF
; 
G
 = 
GG
;

95 
	}
};

98 
	gBCpxFy_di¡_ÿl
::
	$squ¬ed_”rÜ
(
d–
) const {

99 
CC1
, 
DD1
, 
EE1
, 
FF1
, 
GG1
, 
FG1
;

100 
	`ex³ùed_CDEFG
(
d–
, 
CC1
, 
DD1
, 
EE1
, 
FF1
, 
GG1
);

102 
CC1
 = 2 * CC1;

103 
DD1
 = 2 * DD1;

104 
EE1
 = 4 * EE1;

105 
FG1
 = 
FF1
 + 
GG1
;

106 
•sÚ
 = 0.000001;

108 
	`as£¹
(
CC1
 + 
DD1
 + 
EE1
 + 
FG1
 < 1 + 
•sÚ
);

109 
	`as£¹
(
CC1
 + 
DD1
 + 
EE1
 + 
FG1
 > 1 - 
•sÚ
);

111 
CC2
 = 
CC_
 / 
num_of_eff_šdividu®s_
;

112 
DD2
 = 
DD_
 / 
num_of_eff_šdividu®s_
;

113 
EE2
 = 
EE_
 / 
num_of_eff_šdividu®s_
;

114 
FG2
 = 
FG_
 / 
num_of_eff_šdividu®s_
;

115 
loss
 = 0.0;

116 
loss
 =†os + (
CC1
 - 
CC2
) * (CC1 - CC2)

117 + (
DD1
 - 
DD2
) * (DD1 - DD2)

118 + (
EE1
 - 
EE2
) * (EE1 - EE2)

119 + (
FG1
 - 
FG2
) * (FG1 - FG2);

122  
loss
;

123 
	}
};

126 
	gBCpxFy_di¡_ÿl
::
	$fšd_İt_d–
() const {

127 
bš_width
 = 0.1 / 
num_of_šdividu®s_
;

128 
İt_d–
 = 
d–_low”_bound_
;

129 
üt_d–
 = 
d–_low”_bound_
;

130 
İt_loss
 = 
	`squ¬ed_”rÜ
(
d–_low”_bound_
);

131 
üt_d–
 <ğ
d–_uµ”_bound_
){

132 
üt_loss
 = 
	`squ¬ed_”rÜ
(
üt_d–
);

133 ià(
üt_loss
 < 
İt_loss
) {

134 
İt_loss
 = 
üt_loss
;

135 
İt_d–
 = 
üt_d–
;

137 
üt_d–
 = c¹_d– + 
bš_width
;

140  
İt_d–
;

141 
	}
};

144 
	glškage_group_BCpxFy
::
lškage_group_BCpxFy
(
_numb”_of_bšs
,

145 
_numb”_of_šdividu®s
,

146 
_BC_g’”©iÚ_šdex
,

147 
_F_g’”©iÚ_šdex
,

148 
DF
* 
_df
,

149 cÚ¡ 
veùÜ
<veùÜ<
®Ël_¡©e
> >& 
_¿w_d©a
,

150 cÚ¡ 
veùÜ
<>& 
_cu¼’t_Üd”
,

151 cÚ¡ 
veùÜ
<
·œ
<,> >& 
_missšg_d©a
){

152 
	gnumb”_of_bšs
 = 
_numb”_of_bšs
;

153 
	gnumb”_of_šdividu®s
 = 
_numb”_of_šdividu®s
;

154 
	g¿w_d©a
 = 
_¿w_d©a
;

155 
	gBC_g’”©iÚ_šdex_
 = 
_BC_g’”©iÚ_šdex
;

156 
	gF_g’”©iÚ_šdex_
 = 
_F_g’”©iÚ_šdex
;

157 
	gcu¼’t_Üd”
 = 
_cu¼’t_Üd”
;

158 
	gmissšg_d©a
 = 
_missšg_d©a
;

159 
	gdf
 = 
_df
;

162 ià(
	g¿w_d©a
.
size
(è!ğ
numb”_of_bšs
) {

163 
cout
 << "BAD DATA" << 
’dl
;

164 
as£¹
(
çl£
);

167 
	g·œ_wi£_di¡ªûs
.
»size
(
numb”_of_bšs
);

168 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

169 (
	g·œ_wi£_di¡ªûs
[
ii
]).
»size
(
numb”_of_bšs
);

173 
ÿlcuÏ‹_·œ_wi£_di¡ªû
();

175 
	gcu¼’t_uµ”_bound
 = 0 ;

176 
	gii
 = 1 ; i˜< 
	gnumb”_of_bšs
; ii++) {

177 
	gcu¼’t_uµ”_bound
 = 
cu¼’t_uµ”_bound
 + 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
-1]][current_order[ii]];

179 
	gco¡_aá”_š™Ÿliz©iÚ
 = 0 ;

180 
	gMST_low”_bound
 = 0;

185 
	glškage_group_BCpxFy
::~
	$lškage_group_BCpxFy
(){

187 
	}
}

190 
	glškage_group_BCpxFy
::
	$ÿlcuÏ‹_·œ_wi£_di¡ªû
(){

191 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_bšs
);

192 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

194 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_bšs
);

196 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

198 
jj
 = 
ii
 + 1 ; jj < 
numb”_of_bšs
; jj++)

200 
BCpxFy_di¡_ÿl
 
	`bıxfy_di¡
(
BC_g’”©iÚ_šdex_
, 
F_g’”©iÚ_šdex_
, 
¿w_d©a
[
ii
],„aw_d©a[
jj
]);

201 
di¡ªû_ii_jj
 = 
bıxfy_di¡
.
	`Di¡
();

202 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
di¡ªû_ii_jj
;

203 
·œ_wi£_di¡ªûs
[
jj
][
ii
] = 
di¡ªû_ii_jj
;

206 
ii
 = 0; i˜< 
numb”_of_bšs
; ii++) {

207 
·œ_wi£_di¡ªûs
[
ii
][ii] = 0.0;

210 
	}
}

213 
	glškage_group_BCpxFy
::
	$e¡im©e_missšg_d©a
() {

216 
	}
};

219 
	glškage_group_BCpxFy
::
	$dump
() const {

220 
	`dump_commÚ
();

221 
cout
 << "g’”©iÚ_šdex:" << 
g’”©iÚ_šdex_
 << 
’dl
;

222 
cout
 << "Th¿w d©¨Üd”ed" << 
’dl
;

223 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++) {

224 
jj
 = 
cu¼’t_Üd”
[
ii
];

225 
kk
 = 0 ; kk < 
numb”_of_šdividu®s
 ; kk++) {

226 ià((
¿w_d©a
[
jj
][
kk
].
A
 >„aw_d©a[jj][kk].
B
è
ªd


227 (
¿w_d©a
[
jj
][
kk
].
A
 >„aw_d©a[jj][kk].
AB
)) {

228 
cout
 << '.';

229 } ià((
¿w_d©a
[
jj
][
kk
].
B
 >„aw_d©a[jj][kk].
A
è
ªd


230 (
¿w_d©a
[
jj
][
kk
].
B
 >„aw_d©a[jj][kk].
AB
)) {

231 
cout
 << '#';

233 
cout
 << '+';

236 
cout
 << 
’dl
;

238 
	}
};

241 
	glškage_group_BCpxFy
::
	$Üd”_m¬k”s
() {

242 
veùÜ
<> 
Ï¡_Üd”
 = 
cu¼’t_Üd”
;

243 
Ï¡_uµ”_bound
 = 
cu¼’t_uµ”_bound
;

244 
boŞ
 
to_cÚtšue
 = 
Œue
;

245 
to_cÚtšue
) {

246 
to_cÚtšue
 = 
çl£
;

247 
veùÜ
<veùÜ<> > 
di¡ªû_š_cM
;

248 
	`g’”©e_di¡ªû_š_cM
(
di¡ªû_š_cM
);

250 
MSTO±
 
	`İt_™”
(
di¡ªû_š_cM
, 
numb”_of_bšs
, 1);

251 
İt_™”
.
	`O±_Ord”
(
cu¼’t_Üd”
, 
MST
, 
MST_low”_bound
, 
cu¼’t_uµ”_bound
, 
co¡_aá”_š™Ÿliz©iÚ
);

253 
boŞ
 
Üd”_chªged
 = 
çl£
;

254 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii ++) {

255 ià(
Ï¡_Üd”
[
ii
] !ğ
cu¼’t_Üd”
[ii]) {

256 
Üd”_chªged
 = 
Œue
;

259 ià((
Üd”_chªged
è
	`ªd
 (
missšg_d©a
.
	`size
(è> 0èªd (
cu¼’t_uµ”_bound
 < 
Ï¡_uµ”_bound
 + 
ZERO_MINUS
 )) {

260 
to_cÚtšue
 = 
Œue
;

261 
Ï¡_Üd”
 = 
cu¼’t_Üd”
;

262 
Ï¡_uµ”_bound
 = 
cu¼’t_uµ”_bound
;

263 
	`e¡im©e_missšg_d©a
();

264 
cout
 << "¡¬ˆ¨Ãw i‹¿tiÚ" << 
’dl
;

267 
	}
};

	@linkage_group_BCpxFy.h

10 #iâdeà
__LINKAGE_GROUP_BCPXFY_H__


11 
	#__LINKAGE_GROUP_BCPXFY_H__


	)

13 
	~<ÿs£¹
>

14 
	~<veùÜ
>

15 
	~"lškage_group.h
"

16 
	~"MSTO±.h
"

17 
	~"def.h
"

19 
usšg
 
Çme¥aû
 
	g¡d
;

29 şas 
	cBCpxFy_di¡_ÿl
{

30 
	mpublic
:

31 
BCpxFy_di¡_ÿl
(
_BC_g’”©iÚ_šdex
, 
_F_g’”©iÚ_šdex
, cÚ¡ 
veùÜ
<
®Ël_¡©e
>& 
_m¬k”1
, cÚ¡ veùÜ<®Ël_¡©e>& 
_m¬k”2
)

32 :
BC_g’”©iÚ_šdex_
(
_BC_g’”©iÚ_šdex
),

33 
F_g’”©iÚ_šdex_
(
_F_g’”©iÚ_šdex
),

34 
m¬k”1_
(
_m¬k”1
),

35 
	$m¬k”2_
(
_m¬k”2
){

36 
num_of_eff_šdividu®s_
 = 0;

37 
	`as£¹
(
m¬k”1_
.
	`size
(è=ğ
m¬k”2_
.size());

38 
num_of_šdividu®s_
 = 
m¬k”1_
.
	`size
();

39 
	`couÁ_şass
();

40 
	`uµ”_bound
();

41 
	`low”_bound
();

43 
	$Di¡
() const {

44 
İt_d–
 = 
	`fšd_İt_d–
();

45  
İt_d–
 * 
num_of_šdividu®s_
;

46 
	}
};

47 
	g´iv©e
:

48 
couÁ_şass
();

49 
uµ”_bound
();

50 
low”_bound
();

52 
	$ex³ùed_CDEFG
(
d–
,

53 & 
C
,

54 & 
D
,

55 & 
E
,

56 & 
F
,

57 & 
G
) const;

59 
	$squ¬ed_”rÜ
(
d–
) const;

61 
	$fšd_İt_d–
() const;

68 
BC_g’”©iÚ_šdex_
;

69 
F_g’”©iÚ_šdex_
;

72 
num_of_šdividu®s_
;

73 
num_of_eff_šdividu®s_
;

74 cÚ¡ 
veùÜ
<
®Ël_¡©e
>& 
m¬k”1_
;

75 cÚ¡ 
veùÜ
<
®Ël_¡©e
>& 
m¬k”2_
;

85 
CC_
;

86 
DD_
;

87 
EE_
;

88 
FG_
;

89 
d–_uµ”_bound_
;

90 
d–_low”_bound_
;

91 
	}
};

100 şas 
	clškage_group_BCpxFy
: 
public
 
lškage_group
 {

101 
public
:

102 
lškage_group_BCpxFy
(
_numb”_of_bšs
,

103 
_numb”_of_šdividu®s
,

104 
_BC_g’”©iÚ_šdex
,

105 
_F_g’”©iÚ_šdex
,

106 
DF
* 
_df
,

107 cÚ¡ 
veùÜ
<veùÜ<
®Ël_¡©e
> >& 
_¿w_d©a
,

108 cÚ¡ 
veùÜ
<>& 
_cu¼’t_Üd”
,

109 cÚ¡ 
veùÜ
<
·œ
<,> >& 
_missšg_d©a
);

110 ~
lškage_group_BCpxFy
();

112 
	$dump
() const;

114 
	`Üd”_m¬k”s
();

116 
´iv©e
:

119 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

121 
	`e¡im©e_missšg_d©a
();

126 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
¿w_d©a
;

128 
BC_g’”©iÚ_šdex_
;

129 
F_g’”©iÚ_šdex_
;

130 
p_
;

	@linkage_group_DH.cpp

10 
	~"lškage_group_DH.h
"

11 
	~<lim™s
>

15 
	glškage_group_DH
::
lškage_group_DH
(
_numb”_of_bšs
,

16 
_numb”_of_šdividu®s
,

17 
boŞ
 
_d‘eù_bad_d©a
,

18 
ObjFunc
 
_objeùive_funùiÚ
,

19 
DF
* 
_df
,

20 cÚ¡ 
veùÜ
<veùÜ<> > & 
_¿w_d©a
,

21 cÚ¡ 
veùÜ
<> & 
_cu¼’t_Üd”
,

22 cÚ¡ 
veùÜ
<
·œ
<, > > & 
_missšg_d©a
,

23 cÚ¡ 
veùÜ
<>& 
_bš_sizes
) {

24 
	gnumb”_of_bšs
 = 
_numb”_of_bšs
;

25 
	gnumb”_of_šdividu®s
 = 
_numb”_of_šdividu®s
;

26 
	gd‘eù_bad_d©a
 = 
_d‘eù_bad_d©a
;

27 
	gobjeùive_funùiÚ
 = 
_objeùive_funùiÚ
;

28 
	g¿w_d©a
 = 
_¿w_d©a
;

29 
	gcu¼’t_Üd”
 = 
_cu¼’t_Üd”
;

30 
	gmissšg_d©a
 = 
_missšg_d©a
;

31 
	gbš_sizes
 = 
_bš_sizes
;

32 
	gdf
 = 
_df
;

34 ià(
	g¿w_d©a
.
size
(è!ğ
numb”_of_bšs
) {

35 
cout
 << "BAD DATA" << 
’dl
;

38 
	g·œ_wi£_di¡ªûs
.
»size
(
numb”_of_bšs
);

39 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

40 (
	g·œ_wi£_di¡ªûs
[
ii
]).
»size
(
numb”_of_bšs
);

47 
	g™”©iÚ_numb”
 = 2;

48 
	gd©a_¡©us
.
ş—r
();

49 
	gd©a_¡©us
.
»size
(
numb”_of_bšs
);

50 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

51 
	gd©a_¡©us
[
ii
].
»size
(
numb”_of_šdividu®s
);

53 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

54 
	gjj
 = 0; jj < 
	gnumb”_of_šdividu®s
; jj++) {

55 
	gd©a_¡©us
[
ii
][
jj
] = 0;

58 
	gii
 = 0; i˜< 
	g_missšg_d©a
.
size
(); ii++) {

59 
	gm¬k”_id
 = 
_missšg_d©a
[
ii
].
fœ¡
;

60 
	gšdividu®_id
 = 
_missšg_d©a
[
ii
].
£cÚd
;

61 
	gd©a_¡©us
[
m¬k”_id
][
šdividu®_id
] = 1;

74 
ÿlcuÏ‹_·œ_wi£_di¡ªû_š™Ÿlize
();

76 
	gcu¼’t_uµ”_bound
 = 0 ;

77 
	gii
 = 1 ; i˜< 
	gnumb”_of_bšs
; ii++) {

78 
	gcu¼’t_uµ”_bound
 = 
cu¼’t_uµ”_bound
 + 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
-1]][current_order[ii]];

80 
	gco¡_aá”_š™Ÿliz©iÚ
 = 0 ;

81 
	gMST_low”_bound
 = 0;

82 
	gsu¥icious_d©a
.
ş—r
();

86 
	glškage_group_DH
::~
	$lškage_group_DH
()

89 
	}
};

93 
	glškage_group_DH
::
	$d‘eù_bad_m¬k”s
(){

94 
tÙ®_bad_this_™”
 = 0;

95 ià(
numb”_of_bšs
 < 3) {

96  
tÙ®_bad_this_™”
;

99 
mask_th»shŞd
 = 
kMaskTh»shŞd
 - 
kMaskDeüem’t
 * (
™”©iÚ_numb”
 - 3);

100 ià(
mask_th»shŞd
 < 
kMšMaskTh»shŞd
) {

101 
mask_th»shŞd
 = 
kMšMaskTh»shŞd
;

104 
ii
 = 0; i˜< 
numb”_of_bšs
; ii++) {

105 ià(
bš_sizes
[
ii
] > 1) {

110 
veùÜ
<
·œ
<, > > 
di¡ªûs
;

111 
jj
 = 0; jj < 
numb”_of_bšs
; jj++) {

112 ià(
ii
 !ğ
jj
) {

113 
di¡ªûs
.
	`push_back
(
	`make_·œ
(
·œ_wi£_di¡ªûs
[
ii
][
jj
], jj));

116 
	`as£¹
(
di¡ªûs
.
	`size
(è=ğ(
numb”_of_bšs
 - 1));

117 
	`sÜt
(
di¡ªûs
.
	`begš
(), di¡ªûs.
	`’d
());

118 
	`as£¹
(
di¡ªûs
[0].
fœ¡
 <= distances[1].first);

119 
bad_d‘_max_num
 = 
kBadD‘MaxNum
;

120 ià(
di¡ªûs
.
	`size
(è< 
kBadD‘MaxNum
) {

121 
bad_d‘_max_num
 = 
di¡ªûs
.
	`size
();

124 
jj
 = 0; jj < 
numb”_of_šdividu®s
; jj++) {

125 ià(
d©a_¡©us
[
ii
][
jj
] != 0) {

128 
tÙ®_´ob
 = 0.0;

129 
tÙ®_weight
 = 0.0;

130 
kk
 = 0; kk < 
bad_d‘_max_num
; kk++) {

131 if(
di¡ªûs
[
kk
].
fœ¡
 > 0.0) {

132 
tÙ®_´ob
 =otal_prob +

133 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

134 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

135 
¿w_d©a
[
di¡ªûs
[
kk
].
£cÚd
][
jj
] *

136 
bš_sizes
[
di¡ªûs
[
kk
].
£cÚd
];

137 
tÙ®_weight
 =otal_weight +

138 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

139 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

140 
bš_sizes
[
di¡ªûs
[
kk
].
£cÚd
];

143 
p_e¡im©e
 = 0.5;

144 ià(
tÙ®_weight
 > 0.0) {

145 
p_e¡im©e
 = 
tÙ®_´ob
 / 
tÙ®_weight
;

147 ià(
p_e¡im©e
 > 1.0) {

148 
p_e¡im©e
 = 1.0;

150 
p_diff
 = 
p_e¡im©e
 - 
¿w_d©a
[
ii
][
jj
];

151 ià(
p_diff
 < 0.0) {

152 
p_diff
 = -…_diff;

155 ià(
p_diff
 > 
mask_th»shŞd
) {

156 
su¥icious_d©a
.
	`push_back
(
	`make_·œ
(
ii
, 
jj
));

157 
su¥icious_d©a_backup
.
	`push_back
(
¿w_d©a
[
ii
][
jj
]);

158 
d©a_¡©us
[
ii
][
jj
] = 
™”©iÚ_numb”
;

159 
tÙ®_bad_this_™”
 =otal_bad_this_iter + 1;

163 
cout
 << "maskh»shŞd iÀthi ™”©iÚ: " << 
mask_th»shŞd
 << 
’dl
;

164 
cout
 << "id’tif›d " << 
tÙ®_bad_this_™”
 << " d©¨pošt šhi ™”©iÚ" << 
’dl
;

165  
tÙ®_bad_this_™”
;

166 
	}
};

170 
	glškage_group_DH
::
	$»v”t_su¥icious_d©a
(){

171 
	`as£¹
(
su¥icious_d©a
.
	`size
(è=ğ
su¥icious_d©a_backup
.size());

172 
ii
 = 0; i˜< 
su¥icious_d©a
.
	`size
(); ii++){

173 
m¬k”_id
 = 
su¥icious_d©a
[
ii
].
fœ¡
;

174 
šdi_id
 = 
su¥icious_d©a
[
ii
].
£cÚd
;

175 
¿w_d©a
[
m¬k”_id
][
šdi_id
] = 
su¥icious_d©a_backup
[
ii
];

177 
	}
};

180 
	glškage_group_DH
::
	$ÿlcuÏ‹_·œ_wi£_di¡ªû
()

183 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

185 
jj
 = 
ii
 ; jj < 
numb”_of_bšs
; jj++)

187 
·œ_wi£_di¡ªûs
[
ii
][
jj
]=0;

188 ià(
ii
 =ğ
jj
)

190 
·œ_wi£_di¡ªûs
[
ii
][
jj
]=0;

194 
kk
 = 0 ; kk < 
numb”_of_šdividu®s
; kk++)

196 
	`as£¹
(
¿w_d©a
[
ii
][
kk
] <= 1.0);

197 
	`as£¹
(
¿w_d©a
[
ii
][
kk
] >= 0.0);

198 
	`as£¹
(
¿w_d©a
[
jj
][
kk
] <= 1.0);

199 
	`as£¹
(
¿w_d©a
[
jj
][
kk
] >= 0.0);

200 
·œ_wi£_di¡ªûs
[
ii
][
jj
] =…air_wise_distances[ii][jj] +

201 (1 - 
¿w_d©a
[
ii
][
kk
]è*„aw_d©a[
jj
][kk] +

202 (1 - 
¿w_d©a
[
jj
][
kk
]è*„aw_d©a[
ii
][kk];

205 
·œ_wi£_di¡ªûs
[
jj
][
ii
] =…air_wise_distances[ii][jj];

208 
	}
};

211 
	glškage_group_DH
::
	$ÿlcuÏ‹_·œ_wi£_di¡ªû_š™Ÿlize
() {

213 
ii
 = 0; i˜< 
numb”_of_bšs
; ii++) {

214 
jj
 = 
ii
; jj < 
numb”_of_bšs
; jj++) {

215 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 0;

216 
nÚe_missšg
 = 0;

217 ià(
ii
 =ğ
jj
) {

218 
·œ_wi£_di¡ªûs
[
ii
][
jj
]=0;

220 
kk
 = 0 ; kk < 
numb”_of_šdividu®s
; kk++) {

221 ià((
d©a_¡©us
[
ii
][
kk
] =ğ0è
	`ªd
 (d©a_¡©us[
jj
][kk]) == 0) {

222 
nÚe_missšg
 =‚one_missing + 1.0;

223 
·œ_wi£_di¡ªûs
[
ii
][
jj
] =…air_wise_distances[ii][jj] +

224 (1 - 
¿w_d©a
[
ii
][
kk
]è*„aw_d©a[
jj
][kk] +

225 (1 - 
¿w_d©a
[
jj
][
kk
]è*„aw_d©a[
ii
][kk];

228 ià(
nÚe_missšg
 > 0.0) {

229 
·œ_wi£_di¡ªûs
[
ii
][
jj
] =…aœ_wi£_di¡ªûs[ii][jj] / 
nÚe_missšg
 * 
numb”_of_šdividu®s
;

231 
cout
 << "ÿutiÚ,oØmªy missšg c®ls" << 
’dl
;

232 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
numb”_of_šdividu®s
 / 2.0;

235 
·œ_wi£_di¡ªûs
[
jj
][
ii
] =…air_wise_distances[ii][jj];

238 
	}
};

243 
	glškage_group_DH
::
	$dump
() const {

244 
	`dump_commÚ
();

245 
cout
 << "Th¿w d©¨Üd”ed" << 
’dl
;

246 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

248 
jj
 = 
cu¼’t_Üd”
[
ii
];

249 
kk
 = 0 ; kk < 
numb”_of_šdividu®s
 ; kk++)

251 ià(
¿w_d©a
[
jj
][
kk
] > 0.5)

253 
cout
 << '.';

255 ià(
¿w_d©a
[
jj
][
kk
] < 0.5)

257 
cout
 << '#';

261 
cout
 << '-';

264 
cout
 << 
’dl
;

266 
	}
};

269 
	glškage_group_DH
::
	$e¡im©e_missšg_d©a
(){

270 ià(
numb”_of_bšs
 < 3) {

274 
ii
 = 0; i˜< 
numb”_of_bšs
; ii++) {

276 
veùÜ
<
·œ
<, > > 
di¡ªûs
;

277 
jj
 = 0; jj < 
numb”_of_bšs
; jj++) {

278 ià(
ii
 !ğ
jj
) {

279 
di¡ªûs
.
	`push_back
(
	`make_·œ
(
·œ_wi£_di¡ªûs
[
ii
][
jj
], jj));

282 
	`as£¹
(
di¡ªûs
.
	`size
(è=ğ(
numb”_of_bšs
 - 1));

283 
	`sÜt
(
di¡ªûs
.
	`begš
(), di¡ªûs.
	`’d
());

284 
	`as£¹
(
di¡ªûs
[0].
fœ¡
 <= distances[1].first);

285 
bad_d‘_max_num
 = 
kBadD‘MaxNum
;

286 ià(
di¡ªûs
.
	`size
(è< 
kBadD‘MaxNum
) {

287 
bad_d‘_max_num
 = 
di¡ªûs
.
	`size
();

290 
jj
 = 0; jj < 
numb”_of_šdividu®s
; jj++) {

291 ià(
d©a_¡©us
[
ii
][
jj
] == 0) {

294 
tÙ®_´ob
 = 0.0;

295 
tÙ®_weight
 = 0.0;

296 
kk
 = 0; kk < 
bad_d‘_max_num
; kk++) {

297 if(
di¡ªûs
[
kk
].
fœ¡
 > 0.0) {

298 
tÙ®_´ob
 =otal_prob +

299 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

300 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

301 
¿w_d©a
[
di¡ªûs
[
kk
].
£cÚd
][
jj
] *

302 
bš_sizes
[
di¡ªûs
[
kk
].
£cÚd
];

303 
tÙ®_weight
 =otal_weight +

304 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

305 (1 / 
di¡ªûs
[
kk
].
fœ¡
) *

306 
bš_sizes
[
di¡ªûs
[
kk
].
£cÚd
];

309 
p_e¡im©e
 = 0.5;

310 ià(
tÙ®_weight
 > 0.0) {

311 
p_e¡im©e
 = 
tÙ®_´ob
 / 
tÙ®_weight
;

313 ià(
p_e¡im©e
 > 1.0) {

314 
p_e¡im©e
 = 1.0;

316 
¿w_d©a
[
ii
][
jj
] = 
p_e¡im©e
;

319 
	}
};

322 
	glškage_group_DH
::
	$Üd”_m¬k”s
() {

323 
cout
 << "Üd” m¬k” v”siÚ 2 " << 
’dl
;

324 
cumuÏtive_”rÜs
 = 0;

325 
üt_numb”_of_”rÜs
 = 0;

326 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû_š™Ÿlize
();

327 
MSTO±
 
	`İt_™”_š™Ÿl
(
·œ_wi£_di¡ªûs
, 
numb”_of_bšs
, 1);

328 
İt_™”_š™Ÿl
.
	`O±_Ord”
(
cu¼’t_Üd”
,

329 
MST
,

330 
MST_low”_bound
,

331 
cu¼’t_uµ”_bound
,

332 
co¡_aá”_š™Ÿliz©iÚ
);

333 
üt_numb”_of_”rÜs
 = 
cu¼’t_uµ”_bound
;

334 
cout
 << "š™ŸÈnumb” oàüoss-ov”s:" << 
üt_numb”_of_”rÜs
 << 
’dl
;

335 
boŞ
 
Úe_mÜe_™”©iÚ
 = 
Œue
;

336 
Úe_mÜe_™”©iÚ
) {

337 
™”©iÚ_numb”
 = iteration_number + 1;

338 
Ãw_”rÜs_d‘eùed
 = 0;

339 ià(
d‘eù_bad_d©a
) {

340 
Ãw_”rÜs_d‘eùed
 = 
	`d‘eù_bad_m¬k”s
();

341 
cumuÏtive_”rÜs
 = cumuÏtive_”rÜ + 
Ãw_”rÜs_d‘eùed
;

342 
	`as£¹
(
cumuÏtive_”rÜs
 =ğ
su¥icious_d©a
.
	`size
());

344 ià((
missšg_d©a
.
	`size
(è> 0è
	`Ü
 (
su¥icious_d©a
.size() > 0)) {

345 
	`e¡im©e_missšg_d©a
();

347 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

348 ià(
™”©iÚ_numb”
 >ğ
kMaxE¼ÜDeùiÚRounds
 + 2è{
Úe_mÜe_™”©iÚ
 = 
çl£
;}

349 ià(
Ãw_”rÜs_d‘eùed
 =ğ0è{
Úe_mÜe_™”©iÚ
 = 
çl£
;}

350 
MSTO±
 
	`İt_™”
(
·œ_wi£_di¡ªûs
, 
numb”_of_bšs
, 1);

351 
İt_™”
.
	`O±_Ord”
(
cu¼’t_Üd”
,

352 
MST
,

353 
MST_low”_bound
,

354 
cu¼’t_uµ”_bound
,

355 
co¡_aá”_š™Ÿliz©iÚ
);

356 
cout
 << "current‚umber ofƒrrors…lus cross-overs:"

357 << 
cu¼’t_uµ”_bound
 + 
su¥icious_d©a
.
	`size
(è<< 
’dl
;

358 if(
cu¼’t_uµ”_bound
 + 
su¥icious_d©a
.
	`size
(è< 
üt_numb”_of_”rÜs
) {

359 
üt_numb”_of_”rÜs
 = 
cu¼’t_uµ”_bound
 + 
su¥icious_d©a
.
	`size
();

361 
Úe_mÜe_™”©iÚ
 = 
çl£
;

365 
	`e¡im©e_missšg_d©a
();

366 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

369 
veùÜ
<veùÜ<> > 
di¡ªû_to_İtimize
;

371 ià(
objeùive_funùiÚ
 =ğ
OBJF_ML
) {

372 
	`g’”©e_di¡ªû_š_ML
(
di¡ªû_to_İtimize
);

373 } ià(
objeùive_funùiÚ
 =ğ
OBJF_CM
) {

374 
	`g’”©e_di¡ªû_š_cM
(
di¡ªû_to_İtimize
);

376 
di¡ªû_to_İtimize
 = 
·œ_wi£_di¡ªûs
;

379 
MSTO±
 
	`İt_™”_fš®
(
di¡ªû_to_İtimize
, 
numb”_of_bšs
, 1);

380 
İt_™”_fš®
.
	`O±_Ord”
(
cu¼’t_Üd”
,

381 
MST
,

382 
MST_low”_bound
,

383 
cu¼’t_uµ”_bound
,

384 
co¡_aá”_š™Ÿliz©iÚ
);

385 
	}
}

	@linkage_group_DH.h

10 #iâdeà
__LINKAGE_GROUP_DH_H__


11 
	#__LINKAGE_GROUP_DH_H__


	)

13 
	~<io¡»am
>

14 
	~<f¡»am
>

15 
	~<veùÜ
>

16 
	~<¡ršg
>

17 
	~<cm©h
>

18 
	~<ùime
>

19 
	~<ÿs£¹
>

20 
	~<queue
>

21 
	~<ut™y
>

22 
	~<£t
>

23 
	~<®gÜ™hm
>

24 
	~"cÚ¡ªts.h
"

25 
	~"MSTO±.h
"

26 
	~"lškage_group.h
"

29 
usšg
 
Çme¥aû
 
	g¡d
;

31 şas 
	clškage_group_DH
: 
public
 
lškage_group
 {

32 
´iv©e
:

33 
veùÜ
<veùÜ<> > 
¿w_d©a
;

38 
	mveùÜ
<veùÜ<> > 
	md©a_¡©us
;

39 
	m™”©iÚ_numb”
;

41 
	mveùÜ
<> 
	msu¥icious_d©a_backup
;

44 
ÿlcuÏ‹_·œ_wi£_di¡ªû
();

45 
ÿlcuÏ‹_·œ_wi£_di¡ªû_š™Ÿlize
();

46 
d‘eù_bad_m¬k”s
();

47 
»v”t_su¥icious_d©a
();

49 
e¡im©e_missšg_d©a
();

51 
e¡im©e_Úe_missšg
(cÚ¡ 
veùÜ
<>& 
»v_³rm
, 
m¬k”_id
, 
šdi_id
);

53 
	mpublic
:

54 
lškage_group_DH
(
_numb”_of_bšs
,

55 
_numb”_of_šdividu®s
,

56 
boŞ
 
_d‘eù_bad_d©a
,

57 
ObjFunc
 
_objeùive_funùiÚ
,

58 
DF
* 
_df
,

59 cÚ¡ 
veùÜ
<veùÜ<> >& 
_¿w_d©a
,

60 cÚ¡ 
veùÜ
<>& 
_cu¼’t_Üd”
,

61 cÚ¡ 
veùÜ
<
·œ
<,> >& 
_missšg_d©a
,

62 cÚ¡ 
veùÜ
<>& 
_bš_sizes
);

63 ~
lškage_group_DH
();

65 
	$dump
() const;

67 
	`Üd”_m¬k”s
();

	@linkage_group_RIL.cpp

10 
	~"lškage_group_RIL.h
"

13 
	gRIL_di¡_ÿl
::
	$couÁ_şass
(){

14 
CC_
 = 0.0; 
DD_
 = 0.0; 
EE_
 = 0.0; 
FG_
 = 0.0;

15 
•sÚ
 = 0.000001;

16 
ii
 = 0; i˜< 
num_of_šdividu®s_
; ii++) {

17 
m¬k”1_tÙ®
 = 
m¬k”1_
[
ii
].
A
 + m¬k”1_[ii].
B
 + m¬k”1_[ii].
AB
;

18 
m¬k”2_tÙ®
 = 
m¬k”2_
[
ii
].
A
 + m¬k”2_[ii].
B
 + m¬k”2_[ii].
AB
;

19 
	`as£¹
(
m¬k”1_tÙ®
 < 1 + 
•sÚ
);

20 
	`as£¹
(
m¬k”2_tÙ®
 < 1 + 
•sÚ
);

21 
	`as£¹
(
m¬k”1_tÙ®
 > 1 - 
•sÚ
);

22 
	`as£¹
(
m¬k”2_tÙ®
 > 1 - 
•sÚ
);

24 
ii
 = 0; i˜< 
num_of_šdividu®s_
; ii++) {

25 ià((
nÙ
 
m¬k”1_
[
ii
].
missšg
è
	`ªd
 (nÙ 
m¬k”2_
[ii].missing)) {

26 
num_of_eff_šdividu®s_
++;

27 
CC_
 = CC_ + 
m¬k”1_
[
ii
].
A
 * 
m¬k”2_
[ii].A + m¬k”1_[ii].
B
 * marker2_[ii].B;

28 
DD_
 = DD_ + 
m¬k”1_
[
ii
].
A
 * 
m¬k”2_
[ii].
B
 + marker1_[ii].B * marker2_[ii].A;

29 
EE_
 = EE_ + 
m¬k”1_
[
ii
].
AB
 * 
m¬k”2_
[ii].
A
 + m¬k”1_[ii].AB * m¬k”2_[ii].
B


30 + 
m¬k”2_
[
ii
].
AB
 * 
m¬k”1_
[ii].
A
 + m¬k”2_[ii].AB * m¬k”1_[ii].
B
;

31 
FG_
 = FG_ + 
m¬k”1_
[
ii
].
AB
 * 
m¬k”2_
[ii].AB;

34 
tÙ®
 = 
CC_
 + 
DD_
 + 
EE_
 + 
FG_
;

36 
	`as£¹
(
tÙ®
 < 
num_of_eff_šdividu®s_
 + 
•sÚ
);

37 
	`as£¹
(
tÙ®
 > 
num_of_eff_šdividu®s_
 - 
•sÚ
);

38 
	}
};

41 
	gRIL_di¡_ÿl
::
	$uµ”_bound
(){

42 
R
 = (
DD_
 + 
EE_
 + 
FG_
è/ (
CC_
 + DD_ + EE_ + FG_);

43 
d–_uµ”_bound_
 = 
R
 / (2 - 2 * R);

44 ià(
d–_uµ”_bound_
 > 0.5) delta_upper_bound_ = 0.5;

45 
	}
};

48 
	gRIL_di¡_ÿl
::
	$low”_bound
(){

49 
R
 = 
DD_
 / (
CC_
 + DD_ + 
EE_
 + 
FG_
);

50 
d–_low”_bound_
 = 
R
 / (2 - 2 * R);

51 ià(
d–_low”_bound_
 > 0.5) delta_lower_bound_ = 0.5;

52 
	}
};

56 
	gRIL_di¡_ÿl
::
	$ex³ùed_CDEFG
(
d–
,

57 & 
C
,

58 & 
D
,

59 & 
E
,

60 & 
F
,

61 & 
G
) const {

62 
	`as£¹
(
g’”©iÚ_šdex_
 > 1);

63 
CC
 = 0.0;

64 
DD
 = 0.0;

65 
EE
 = 0.0;

66 
FF
 = 1.0;

67 
GG
 = 0.0;

68 
ii
 = 0; i˜< 
g’”©iÚ_šdex_
 - 1; ii++) {

69 
CC_´ime
 = 
CC
 + 0.5 * 
EE
 + 0.25 * (1 - 
d–
è* (1 - d–è* 
FF
 + 0.25 * d– * d– * 
GG
;

70 
DD_´ime
 = 
DD
 + 0.5 * 
EE
 + 0.25 * 
d–
 * d– * 
FF
 + 0.25 * (1 - d–è* (1 - d–è* 
GG
;

71 
EE_´ime
 = 0.5 * 
EE
 + 0.5 * 
d–
 * (1 - d–è* (
FF
 + 
GG
);

72 
FF_´ime
 = 0.5 * (1 - 
d–
è* (1 - d–è* 
FF
 + 0.5 * d– * d– * 
GG
;

73 
GG_´ime
 = 0.5 * 
d–
 * d– * 
FF
 + 0.5 * (1 - d–è* (1 - d–è* 
GG
;

74 
CC
 = 
CC_´ime
; 
DD
 = 
DD_´ime
; 
EE
 = 
EE_´ime
; 
FF
 = 
FF_´ime
; 
GG
 = 
GG_´ime
;

76 
•sÚ
 = 0.000001;

77 
tÙ®
 = 2 * 
CC
 + 2 * 
DD
 + 4 * 
EE
 + 
FF
 + 
GG
;

78 
	`as£¹
(
tÙ®
 < 1 + 
•sÚ
);

79 
	`as£¹
(
tÙ®
 > 1 - 
•sÚ
);

80 
C
 = 
CC
; 
D
 = 
DD
; 
E
 = 
EE
; 
F
 = 
FF
; 
G
 = 
GG
;

82 
	}
};

85 
	gRIL_di¡_ÿl
::
	$squ¬ed_”rÜ
(
d–
) const {

86 
CC1
, 
DD1
, 
EE1
, 
FF1
, 
GG1
, 
FG1
;

87 
	`ex³ùed_CDEFG
(
d–
, 
CC1
, 
DD1
, 
EE1
, 
FF1
, 
GG1
);

89 
CC1
 = 2 * CC1;

90 
DD1
 = 2 * DD1;

91 
EE1
 = 4 * EE1;

92 
FG1
 = 
FF1
 + 
GG1
;

93 
•sÚ
 = 0.000001;

95 
	`as£¹
(
CC1
 + 
DD1
 + 
EE1
 + 
FG1
 < 1 + 
•sÚ
);

96 
	`as£¹
(
CC1
 + 
DD1
 + 
EE1
 + 
FG1
 > 1 - 
•sÚ
);

98 
CC2
 = 
CC_
 / 
num_of_eff_šdividu®s_
;

99 
DD2
 = 
DD_
 / 
num_of_eff_šdividu®s_
;

100 
EE2
 = 
EE_
 / 
num_of_eff_šdividu®s_
;

101 
FG2
 = 
FG_
 / 
num_of_eff_šdividu®s_
;

102 
loss
 = 0.0;

103 
loss
 =†os + (
CC1
 - 
CC2
) * (CC1 - CC2)

104 + (
DD1
 - 
DD2
) * (DD1 - DD2)

105 + (
EE1
 - 
EE2
) * (EE1 - EE2)

106 + (
FG1
 - 
FG2
) * (FG1 - FG2);

109  
loss
;

110 
	}
};

113 
	gRIL_di¡_ÿl
::
	$fšd_İt_d–
() const {

114 
bš_width
 = 0.1 / 
num_of_šdividu®s_
;

115 
İt_d–
 = 
d–_low”_bound_
;

116 
üt_d–
 = 
d–_low”_bound_
;

117 
İt_loss
 = 
	`squ¬ed_”rÜ
(
d–_low”_bound_
);

118 
üt_d–
 <ğ
d–_uµ”_bound_
){

119 
üt_loss
 = 
	`squ¬ed_”rÜ
(
üt_d–
);

120 ià(
üt_loss
 < 
İt_loss
) {

121 
İt_loss
 = 
üt_loss
;

122 
İt_d–
 = 
üt_d–
;

124 
üt_d–
 = c¹_d– + 
bš_width
;

127  
İt_d–
;

128 
	}
};

131 
	glškage_group_RIL
::
lškage_group_RIL
(
_numb”_of_bšs
,

132 
_numb”_of_šdividu®s
,

133 
_g’”©iÚ_šdex
,

134 
DF
* 
_df
,

135 cÚ¡ 
veùÜ
<veùÜ<
®Ël_¡©e
> >& 
_¿w_d©a
,

136 cÚ¡ 
veùÜ
<>& 
_cu¼’t_Üd”
,

137 cÚ¡ 
veùÜ
<
·œ
<,> >& 
_missšg_d©a
){

138 
	gnumb”_of_bšs
 = 
_numb”_of_bšs
;

139 
	gnumb”_of_šdividu®s
 = 
_numb”_of_šdividu®s
;

140 
	g¿w_d©a
 = 
_¿w_d©a
;

141 
	gg’”©iÚ_šdex_
 = 
_g’”©iÚ_šdex
;

142 
	gcu¼’t_Üd”
 = 
_cu¼’t_Üd”
;

143 
	gmissšg_d©a
 = 
_missšg_d©a
;

144 
	gdf
 = 
_df
;

147 ià(
	g¿w_d©a
.
size
(è!ğ
numb”_of_bšs
) {

148 
cout
 << "BAD DATA" << 
’dl
;

149 
as£¹
(
çl£
);

152 
	g·œ_wi£_di¡ªûs
.
»size
(
numb”_of_bšs
);

153 
	gii
 = 0; i˜< 
	gnumb”_of_bšs
; ii++) {

154 (
	g·œ_wi£_di¡ªûs
[
ii
]).
»size
(
numb”_of_bšs
);

158 
ÿlcuÏ‹_·œ_wi£_di¡ªû
();

160 
	gcu¼’t_uµ”_bound
 = 0 ;

161 
	gii
 = 1 ; i˜< 
	gnumb”_of_bšs
; ii++) {

162 
	gcu¼’t_uµ”_bound
 = 
cu¼’t_uµ”_bound
 + 
·œ_wi£_di¡ªûs
[
cu¼’t_Üd”
[
ii
-1]][current_order[ii]];

164 
	gco¡_aá”_š™Ÿliz©iÚ
 = 0 ;

165 
	gMST_low”_bound
 = 0;

170 
	glškage_group_RIL
::~
	$lškage_group_RIL
(){

172 
	}
}

175 
	glškage_group_RIL
::
	$ÿlcuÏ‹_·œ_wi£_di¡ªû
(){

176 
·œ_wi£_di¡ªûs
.
	`»size
(
numb”_of_bšs
);

177 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

179 
·œ_wi£_di¡ªûs
[
ii
].
	`»size
(
numb”_of_bšs
);

181 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++)

183 
jj
 = 
ii
 + 1 ; jj < 
numb”_of_bšs
; jj++)

185 
RIL_di¡_ÿl
 
	`r_di¡
(
g’”©iÚ_šdex_
, 
¿w_d©a
[
ii
],„aw_d©a[
jj
]);

186 
di¡ªû_ii_jj
 = 
r_di¡
.
	`Di¡
();

187 
·œ_wi£_di¡ªûs
[
ii
][
jj
] = 
di¡ªû_ii_jj
;

188 
·œ_wi£_di¡ªûs
[
jj
][
ii
] = 
di¡ªû_ii_jj
;

191 
ii
 = 0; i˜< 
numb”_of_bšs
; ii++) {

192 
·œ_wi£_di¡ªûs
[
ii
][ii] = 0.0;

195 
	}
}

198 
	glškage_group_RIL
::
	$e¡im©e_missšg_d©a
() {

201 
	}
};

204 
	glškage_group_RIL
::
	$dump
() const {

205 
	`dump_commÚ
();

206 
cout
 << "g’”©iÚ_šdex:" << 
g’”©iÚ_šdex_
 << 
’dl
;

207 
cout
 << "Th¿w d©¨Üd”ed" << 
’dl
;

208 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii++) {

209 
jj
 = 
cu¼’t_Üd”
[
ii
];

210 
kk
 = 0 ; kk < 
numb”_of_šdividu®s
 ; kk++) {

211 ià((
¿w_d©a
[
jj
][
kk
].
A
 >„aw_d©a[jj][kk].
B
è
ªd


212 (
¿w_d©a
[
jj
][
kk
].
A
 >„aw_d©a[jj][kk].
AB
)) {

213 
cout
 << '.';

214 } ià((
¿w_d©a
[
jj
][
kk
].
B
 >„aw_d©a[jj][kk].
A
è
ªd


215 (
¿w_d©a
[
jj
][
kk
].
B
 >„aw_d©a[jj][kk].
AB
)) {

216 
cout
 << '#';

218 
cout
 << '+';

221 
cout
 << 
’dl
;

223 
	}
};

226 
	glškage_group_RIL
::
	$Üd”_m¬k”s
() {

227 
veùÜ
<> 
Ï¡_Üd”
 = 
cu¼’t_Üd”
;

228 
Ï¡_uµ”_bound
 = 
cu¼’t_uµ”_bound
;

229 
boŞ
 
to_cÚtšue
 = 
Œue
;

230 
to_cÚtšue
) {

231 
to_cÚtšue
 = 
çl£
;

232 
veùÜ
<veùÜ<> > 
di¡ªû_š_cM
;

233 
	`g’”©e_di¡ªû_š_cM
(
di¡ªû_š_cM
);

235 
MSTO±
 
	`İt_™”
(
di¡ªû_š_cM
, 
numb”_of_bšs
, 1);

236 
İt_™”
.
	`O±_Ord”
(
cu¼’t_Üd”
, 
MST
, 
MST_low”_bound
, 
cu¼’t_uµ”_bound
, 
co¡_aá”_š™Ÿliz©iÚ
);

238 
boŞ
 
Üd”_chªged
 = 
çl£
;

239 
ii
 = 0 ; i˜< 
numb”_of_bšs
; ii ++) {

240 ià(
Ï¡_Üd”
[
ii
] !ğ
cu¼’t_Üd”
[ii]) {

241 
Üd”_chªged
 = 
Œue
;

244 ià((
Üd”_chªged
è
	`ªd
 (
missšg_d©a
.
	`size
(è> 0èªd (
cu¼’t_uµ”_bound
 < 
Ï¡_uµ”_bound
 + 
ZERO_MINUS
 )) {

245 
to_cÚtšue
 = 
Œue
;

246 
Ï¡_Üd”
 = 
cu¼’t_Üd”
;

247 
Ï¡_uµ”_bound
 = 
cu¼’t_uµ”_bound
;

248 
	`e¡im©e_missšg_d©a
();

249 
cout
 << "¡¬ˆ¨Ãw i‹¿tiÚ" << 
’dl
;

252 
	}
};

	@linkage_group_RIL.h

10 #iâdeà
__LINKAGE_GROUP_RIL_H__


11 
	#__LINKAGE_GROUP_RIL_H__


	)

13 
	~<ÿs£¹
>

14 
	~<veùÜ
>

15 
	~"lškage_group.h
"

16 
	~"MSTO±.h
"

17 
	~"def.h
"

19 
usšg
 
Çme¥aû
 
	g¡d
;

21 şas 
	cRIL_di¡_ÿl
{

22 
	mpublic
:

23 
RIL_di¡_ÿl
(
_g’”©iÚ_šdex
, cÚ¡ 
veùÜ
<
®Ël_¡©e
>& 
_m¬k”1
, cÚ¡ veùÜ<®Ël_¡©e>& 
_m¬k”2
)

24 :
g’”©iÚ_šdex_
(
_g’”©iÚ_šdex
),

25 
m¬k”1_
(
_m¬k”1
),

26 
	$m¬k”2_
(
_m¬k”2
){

27 
num_of_eff_šdividu®s_
 = 0;

28 
	`as£¹
(
m¬k”1_
.
	`size
(è=ğ
m¬k”2_
.size());

29 
num_of_šdividu®s_
 = 
m¬k”1_
.
	`size
();

30 
	`couÁ_şass
();

31 
	`uµ”_bound
();

32 
	`low”_bound
();

34 
	$Di¡
() const {

35 
İt_d–
 = 
	`fšd_İt_d–
();

36  
İt_d–
 * 
num_of_šdividu®s_
;

37 
	}
};

38 
	g´iv©e
:

39 
couÁ_şass
();

40 
uµ”_bound
();

41 
low”_bound
();

43 
	$ex³ùed_CDEFG
(
d–
,

44 & 
C
,

45 & 
D
,

46 & 
E
,

47 & 
F
,

48 & 
G
) const;

50 
	$squ¬ed_”rÜ
(
d–
) const;

52 
	$fšd_İt_d–
() const;

59 
g’”©iÚ_šdex_
;

61 
num_of_šdividu®s_
;

62 
num_of_eff_šdividu®s_
;

63 cÚ¡ 
veùÜ
<
®Ël_¡©e
>& 
m¬k”1_
;

64 cÚ¡ 
veùÜ
<
®Ël_¡©e
>& 
m¬k”2_
;

66 
CC_
;

67 
DD_
;

68 
EE_
;

69 
FG_
;

70 
d–_uµ”_bound_
;

71 
d–_low”_bound_
;

72 
	}
};

74 şas 
	clškage_group_RIL
: 
public
 
lškage_group
 {

75 
public
:

76 
lškage_group_RIL
(
_numb”_of_bšs
,

77 
_numb”_of_šdividu®s
,

78 
_g’”©iÚ_šdex
,

79 
DF
* 
_df
,

80 cÚ¡ 
veùÜ
<veùÜ<
®Ël_¡©e
> >& 
_¿w_d©a
,

81 cÚ¡ 
veùÜ
<>& 
_cu¼’t_Üd”
,

82 cÚ¡ 
veùÜ
<
·œ
<,> >& 
_missšg_d©a
);

83 ~
lškage_group_RIL
();

85 
	$dump
() const;

87 
	`Üd”_m¬k”s
();

89 
´iv©e
:

92 
	`ÿlcuÏ‹_·œ_wi£_di¡ªû
();

94 
	`e¡im©e_missšg_d©a
();

99 
veùÜ
<veùÜ<
®Ël_¡©e
> > 
¿w_d©a
;

100 
g’”©iÚ_šdex_
;

	@main.cpp

1 
	~<io¡»am
>

2 
	~<c¡dlib
>

4 
	~"cÚ¡ªts.h
"

5 
	~"lškage_group_DH.h
"

6 
	~"g’‘ic_m­_DH.h
"

7 
	~"g’‘ic_m­_RIL.h
"

8 
usšg
 
Çme¥aû
 
	g¡d
;

10 
	$u§ge
(* cÚ¡ 
¬gv
[]){

11 
cout
 << "NAME" << 
’dl
;

12 
cout
 << "\tMSTm­ - bud g’‘iøm­ fÜ inb»d†šes" << 
’dl
;

14 
cout
 << "SYNOPSIS" << 
’dl
;

15 
cout
 << "\t" << 
¬gv
[0] << " <šput_fe> <ouut_fe>" << 
’dl
;

17 
cout
 << "DESCRIPTION" << 
’dl
;

18 
cout
 << "\tMSTMap is‡ softwareoolhat is capable of constructing genetic†inkage maps\n"

26 << "\tHowev”, wh’hd©¨¬noisy,hm­ g’”©ed by ou¸®gÜ™hm‡» signifiÿÁly b‘‹r." << 
’dl
;

28 
cout
 << "DETAILS" << 
’dl
;

29 
cout
 << "\tS“ <h‰p://®umni.cs.uü.edu/~yÚghui/m¡m­.html>" << 
’dl
;

31 
cout
 << "AUTHOR" << 
’dl
;

32 
cout
 << "\tWr™‹Àby YÚgHui." << 
’dl
;

34 
cout
 << "REPORTING BUGS" << 
’dl
;

35 
cout
 << "\tR•Üˆbug tØ<yÚghui@cs.uü.edu>." << 
’dl
;

36 
	}
}

38 
	$maš
 (
¬gc
, * cÚ¡ 
¬gv
[]) {

40 ià(
¬gc
 != 3) {

41 
	`u§ge
(
¬gv
);

46 
if¡»am
 
	`¿w_m­pšg_d©a_fe
(
¬gv
[1]);

47 
¡ršg
 
tmp_¡r
;

48 
¡ršg
 
pİuÏtiÚ_ty³
;

50 
¿w_m­pšg_d©a_fe
 >> 
tmp_¡r
;

51 ià(
tmp_¡r
 != "population_type")

53 
cout
 << "ERROR,hšpuˆfi šv®id" << 
’dl
;

54 
	`as£¹
(
çl£
);

57 
¿w_m­pšg_d©a_fe
 >> 
pİuÏtiÚ_ty³
;

58 
¿w_m­pšg_d©a_fe
.
	`şo£
();

60 
g’‘ic_m­
* 
b¬Ëy
;

61 ià(
pİuÏtiÚ_ty³
 == "DH") {

63 
b¬Ëy
 = 
Ãw
 
	`g’‘ic_m­_DH
();

65 }if((
pİuÏtiÚ_ty³
[0] =ğ'R'è
	`ªd
 (population_type[1] == 'I')‡nd (population_type[2] == 'L')) {

68 
b¬Ëy
 = 
Ãw
 
	`g’‘ic_m­_RIL
();

70 }if((
pİuÏtiÚ_ty³
[0] =ğ'B'è
	`ªd
 (population_type[1] == 'C')) {

73 
b¬Ëy
 = 
Ãw
 
	`g’‘ic_m­_BCpxFy
();

76 
cout
 << "ERROR,hpİuÏtiÚy³ i šv®id, oÆy‡cû± DH, BCpxFy‡nd Rs" << 
’dl
;

77 
	`as£¹
(
çl£
);

81 
b¬Ëy
->
	`»ad_¿w_m­pšg_d©a
(
¬gv
[1]);

84 
b¬Ëy
->
	`g’”©e_m­
();

86 
of¡»am
 
	`ouut_fe
(
¬gv
[2]);

87 
b¬Ëy
->
	`wr™e_ouut
(
ouut_fe
);

88 
ouut_fe
.
	`şo£
();

90 
d–‘e
 
b¬Ëy
;

92 
	}
}

94 
´št_veùÜ
(
veùÜ
<> 
tmp
)

96 
	gii
 = 0 ; i˜< 
	gtmp
.
size
(); ii++)

98 
	gcout
 << 
	gii
 << ',' ;

100 
	gcout
 << 
	g’dl
;

	@
1
.
1
/usr/include
21
359
MSTOpt.cpp
MSTOpt.h
constants.h
def.h
genetic_map.cpp
genetic_map.h
genetic_map_BCpxFy.cpp
genetic_map_BCpxFy.h
genetic_map_DH.cpp
genetic_map_DH.h
genetic_map_RIL.cpp
genetic_map_RIL.h
linkage_group.cpp
linkage_group.h
linkage_group_BCpxFy.cpp
linkage_group_BCpxFy.h
linkage_group_DH.cpp
linkage_group_DH.h
linkage_group_RIL.cpp
linkage_group_RIL.h
main.cpp
